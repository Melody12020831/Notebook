---
statistics: True
comments: true
---

# Chapter 1

## 网络、互连网（互联网）与因特网的区别与关系

![img](./assets/1-1.png)

计算机网络（简称网络）：指的是由若干节点（如计算机、打印机等）和连接这些节点的链路（有线或无线）组成的集合。一个网络通常覆盖范围有限，比如一个家庭、办公室或校园内部的局域网（LAN）。

互连网（互联网）（internet）：是指由多个网络通过路由器等设备互连起来形成的更大范围的网络。互连网可以是企业内部多个局域网的互联，也可以是全球范围的网络互联。因特网（Internet）就是最大的互连网。

因特网（Internet）：专指全球范围内采用TCP/IP协议族互连起来的、覆盖全球的特定互连网。它是目前世界上最大的、开放的、公共的互连网。

![img](./assets/1-2.png)

---

## 因特网简介

![img](./assets/1-3.png)

因特网服务提供者（Internet Service Provider，**ISP**）

---

### 因特网的标准化工作

因特网的标准化工作是面向公众的，其任何一个建议标准在成为因特网标准之前都以RFC技术文档的形式在因特网上发表。

RFC（Request For Comments）的意思是“请求评论”。任何人都可以从因特网上免费下载RFC文档（http://www.ietf.org/rfc.html），并随时对某个RFC文档发表意见和建议。

![img](./assets/1-4.png)

---

### 因特网的组成

从不同的角度看，可将计算机网络的组成分为如下几类。

1) 从组成部分看，计算机网络主要由硬件、软件、协议三大部分组成。硬件主要由主机(也称端系统)、通信链路(如双绞线、光纤)、交换设备(如路由器、交换机等)和通信处理机(如网卡)等组成。软件主要包括各种实现资源共享的软件和方便用户使用的各种工具软件(如E-mail程序、FTP程序、聊天程序等)。协议是计算机网络的核心，如同交通规则制约汽车驾驶一样，协议规定了网络传输数据时所遵循的规范。

2) 从工作方式看，计算机网络(这里主要指Internet,即互联网)可分为边缘部分和核心部分。边缘部分由所有连接到互联网上的供用户直接使用的主机组成，用来进行通信(如传输数据、音频或视频)和资源共享；核心部分由大量网络和连接这些网络的路由器组成，它为边缘部分提供连通性和交换服务。图1.1给出了互联网核心部分与边缘部分的示意图。

![img](./assets/1-5.png)

---

## 电路交换、报文交换和分组交换

### 电路交换

电路交换分为三步：建立连接(开始占用通信资源)、传输数据(一直占用通信资源)和释放连接(归还通信资源)。

在进行数据传输前，两个用户之间必须先建立一条专用的物理通信路径(由通信双方之间的交换设备和链路逐段连接而成)。在数据传输过程中，这一物理通信路径始终被两个用户独占，直到通信结束后才被释放。

![img](./assets/1-6.png)

电路交换技术的优点：

1. 通信时延小。因为通信线路为通信双方专用，数据直达，所以传输速率高。
2. 有序传输。双方通信时按发送顺序传送数据，不存在失序问题。
3. 没有冲突。不同的通信双方拥有不同的信道，不会出现争用物理信道的问题。
4. 实时性强。通信双方之间的物理通路一旦建立，双方就可随时通信。

电路交换技术的缺点：

1. 建立连接时间长。电路交换的平均连接建立时间对计算机通信来说太长。
2. 线路利用率低。物理通路被通信双方独占，即使线路空闲，也不能供其他用户使用。
3. 灵活性差。物理通路中的任何一点出现故障，就必须重新拨号建立新的连接。
4. 难以实现差错控制。中间节点不具备存储和检验数据的能力，无法发现并纠正错误。

计算机之间的数据传送往往是突发式(高频、少量)的，当使用电路交换来传送数据时，已被用户占用的通信线路资源在绝大部分时间里都是空闲的，其利用率往往不到 10% 甚至 1% 。

---

### 报文交换

数据交换的单位是报文，用户数据加上源地址、目的地址等信息后，后封装成报文(Message)。报文交换采用存储转发技术，整个报文先传送到相邻的节点，全部存储后查找转发表，转发到下一个节点，如此重复，直至到达目的节点。每个报文都可单独选择到达目的端的路径。

报文交换技术的优点：

1. 无建立连接时延。通信前无须建立连接，没有建立连接时延，用户可随时发送报文。
2. 灵活分配线路。交换节点存储整个报文后，选择一条合适的空闲线路，转发报文。若某条传输路径发生故障，则可重新选择另一条路径传输数据。
3. 线路利用率高。报文在一段链路上传送时才占用这段链路的通信资源。
4. 支持差错控制。交换节点可对缓存下来的报文进行差错检验。

报文交换技术的缺点：

1. 转发时延高。交换节点要将报文整体接收完后，才能查找转发表转发到下一个节点。
2. 缓存开销大。报文的大小没有限制，这就要求交换节点拥有较大的缓存空间。
3. 错误处理低效。报文较长时，发生错误的概率相对更大，重传整个报文的代价也很大。

---

### 分组交换

分组交换也采用存储转发技术，但解决了报文交换中报文过长的问题。若报文太长，则对交换节点的缓存容量就有很大的需求，在错误处理方面也比较低效。源主机在发送之前，先把较长的报文划分成若干较小的等长数据段，在每个数据段前面添加一些由必要控制信息(如源地址、目的地址和编号信息等)组成的首部，构成分组(Packet)。

分组交换除继承报文交换的诸多优点外，还有如下优点：

1. 方便存储管理，存储转发开销小。因为分组的长度固定，所以相应缓冲区的大小也固定。
2. 传输效率高。分组是逐个传输的，可以使后一个分组的存储操作与前一个分组的转发操作并行，这种流水线方式减少了报文的传输时间。
3. 减少了出错概率和重传代价。因为分组较短，其出错概率必然减小，所以每次重发的数据量也就大大减少，这样不仅提高了可靠性，还减小了传输时延。

分组交换技术的缺点：

1. 存在存储转发时延。尽管分组交换比报文交换的传输时延小，但相对于电路交换仍存在存储转发时延，且其节点交换机必须具有更强的处理能力。
2. 需要传输额外的信息量。每个小数据段都要加上控制信息以构成分组，这使得传送的信息量增大了5%～10%,进而使得控制复杂，降低了通信效率。
3. 当分组交换网采用数据报服务时，可能出现失序、丢失或重复分组的情况，分组到达目的主机时，要对分组按编号进行排序等工作，而这些工作很麻烦。若采用虚电路服务，则虽然没有失序问题，但有呼叫建立、数据传输和虚电路释放三个过程。

![img](./assets/1-7.png)

---

## 计算机网络的定义

计算机网络早期的一个最简单定义：

1. 互连：指网络中的各个计算机或设备通过物理链路（如网线、光纤、无线等）连接起来，能够相互通信和交换数据。
2. 自治：每台计算机在网络中都是独立的、自治的系统，可以自主运行自己的操作系统和应用程序。
3. 计算机集合：网络是由多台计算机构成的集合体，而不是单一的计算机。

现阶段计算机网络的一个较好的定义：

计算机网络主要是由一些通用的、可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用。

---

## 计算机网络的分类

### 按分布范围分类

1. 广域网(WAN)。广域网的任务是提供长距离通信，运送主机所发送的数据，其覆盖范围通常是直径为几十米到几千千米的区域。广域网是互联网的核心部分。连接广域网的各节点交换机的链路一般都是高速链路，具有较大的通信容量。
2. 城域网(MAN)。城域网的覆盖范围可以跨越几个街区甚至整个城市，覆盖区域的直径为5~50km。城域网大多采用以太网技术，因此有时也常并入局域网的范围讨论。
3. 局域网(LAN)。局域网一般用主机通过高速线路相连，覆盖范围较小，通常是直径为几十到几千米的区域。传统上，局域网使用广播技术，而广域网使用交换技术。
4. 个人区域网(PAN)。个人区域网是指在个人工作的地方将消费电子设备(如平板电脑、智能手机等)用无线技术连接起来的网络，也称无线个人区域网(WPAN)。

![img](./assets/1-8.png)

---

### 按传输技术分类

1. 广播式网络。所有联网计算机都共享一个公共通信信道。当一台计算机利用共享通信信道发送报文分组时，所有其他计算机都会“收听”到这个分组。“收听”到该分组的计算机将通过检查目的地址来决定是否接收该分组。局域网基本上都采用广播式通信技术广域网中的无线、卫星通信网络也采用广播式通信技术。
2. 点对点网络。每条物理线路连接一对计算机。若通信的两台主机之间没有直接连接的线路，则它们之间的分组传输就要通过中间节点进行存储和转发，直至目的主机。

---

### 按拓扑结构分类

网络拓扑结构是指由网中节点(路由器、主机等)与通信线路之间的几何关系表示的网络结构，主要指通信子网的拓扑结构。按拓扑结构，网络可分为总线形、星形、环形和网状网络等。

星形、总线形和环形网络多用于局域网，网状网络多用于广域网。

??? info "原因"
    星形、总线形和环形网络多用于局域网: 局域网覆盖范围小，节点数量有限，通常在一个办公室、楼宇或校园内部。这些拓扑结构布线简单、成本低、易于管理和维护，适合小范围、节点数量不多的环境。星形结构便于集中管理，总线结构布线经济，环形结构易于实现令牌环协议。

    网状网络多用于广域网: 广域网覆盖范围大，节点数量多，通常跨越城市、地区甚至国家。网状结构具有高可靠性和冗余性，任意两个节点之间可以有多条路径，适合大规模、复杂的网络环境。当某条链路或节点出现故障时，数据可以通过其他路径绕行，提高了网络的健壮性和容错能力。这对于广域网这种需要高可用性和大规模互联的场景非常重要。

![img](./assets/1-9.png)

1. 总线形网络。用单根传输线把计算机连接起来。优点是建网容易、增/减节点方便、节省线路。缺点是重负载时通信效率不高、总线任意一处对故障敏感。
2. 星形网络。每个终端或计算机都以单独的线路与中央设备相连。中央设备一般是交换机或路由器。优点是便于集中控制和管理。缺点是成本高、中央设备对故障敏感。
3. 环形网络。所有计算机接口设备连接成一个环。环形网络最典型的例子是令牌环局域网。环既可以是单环，又可以是双环，环中信号是单向传输的。
4. 网状网络。一般情况下，每个节点至少有两条路径与其他节点相连，多用在广域网中。其有规则型和非规则型两种。优点是可靠性高。缺点是控制复杂、线路成本高。

以上4种基本的网络拓扑结构可以互连为更复杂的网络。

---

### 按使用者分类

1. 公用网(Public Network)。指电信公司出资建造的大型网络。“公用”的意思是指所有愿意按电信公司的规定缴纳费用的人都可使用这种网络。
2. 专用网(Private Network)。指某个单位为满足本单位特殊业务的需要而建造的网络。这种网络不向本单位外的人提供服务，如铁路、电力、军队等部门的专用网。

---

### 按传输介质分类

传输介质可分为有线和无线两大类，因此网络可分为有线网络和无线网络。

有线网络又可分为双绞线网络、同轴电缆网络等。

而无线网络又可分为蓝牙、微波、无线电等类型。

---

## 计算机网络的性能指标

### 速率(Speed)

指连接到网络上的节点在数字信道上传送数据的速率，也称数据传输速率、数据率或比特率，单位为 b/s（比特/秒）或 bit/s（有时也写做bps）。

![img](./assets/1-10.png)

???+ example
    有一个待发送的数据块，大小为100MB，网卡的发送速率为100Mbps，则网卡发送完该数据块需要多长时间？

??? tip "answer"
    $\frac{100MB}{100Mbps} = \frac{100 \times 2^{20}}{100 \times 10^6} s = \frac{2^{20}}{10^6} s \approx 8 s$

---

### 带宽(Bandwidth)

带宽原本表示通信线路允许通过的信号频率范围，单位是赫兹(Hz)。但在计算机网络中，带宽表示网络的通信线路所能传送数据的能力，是数字信道所能传送的“最高数据传输速率”的同义语，单位是比特/秒(b/s)。

数据传送速率 = min [ 主机接口速率，线路带宽，交换机或路由器的接口速率 ]

![img](./assets/1-11.png)

---

### 吞吐量(Throughput)

指单位时间内通过某个网络(或信道、接口)的实际数据量。吞吐量常用于对实际网络的测量，以便获知到底有多少数据量能够通过网络。

吞吐量受网络带宽的限制。

![img](./assets/1-12.png)

---

### 时延(Delay)

指数据(一个报文或分组)从网络(或链路)的一端传送到另一端所需的总时间，它由4部分构成:发送时延、传播时延、处理时延和排队时延。

1. 发送时延，也称传输时延。节点将分组的所有比特推向链路所花的时间，即从发送分组的第一个比特算起，到该分组的最后一个比特发送完毕所花的时间。

$$\text{发送时延}=\frac{\text{分组长度}}{\text{发送速率}}

2. 传播时延。电磁波在信道(传输介质)中传播一定的距离所花的时间，即一个比特从链路的一端传播到另一端所需的时间。

$$\text{传播时延}=\frac{\text{信道长度}}{\text{电磁波在信道上的传播速率}}$$

!!! tip "区分传输时延和传播时延"
    传输时延是节点将分组推向网络所需的时间，它取决于分组长度和发送速率。
    
    传播时延是一个比特从一个节点传播至另一节点所需的时间，它取决干两个节点之间距离和信道所使用的传输介质，而与分组长度或发送速率无关。

- 自由空间： $3.0 \times 10^8 m/s$
- 光纤： $2.0 \times 10^8 m/s$
- 铜缆： $2.3 \times 10^8 m/s$

3. 处理时延。分组在交换节点为存储转发而进行的一些必要处理所花的时间。例如，分析分组的首部、差错检验或查找合适的路由等。

4. 排队时延。分组在路由器的输入队列或输出队列中排队等待所花的时间。

因此，数据在网络中经历的总时延就是以上4部分时延之和:

$$\text{总时延}=\text{发送时延}+\text{传播时延}+\text{处理时延}+\text{排队时延}$$

在考试中，通常不用考虑处理时延和排队时延(除非另有说明)。

![img](./assets/1-13.png)

???+ example
    ![img](./assets/1-14.png)

??? tip "answer"
    ![img](./assets/1-15.png)

???+ example
    数据块长度为100MB，信道带宽为1Mb/s，传送距离为1000KM，传输介质为光纤，计算发送时延和传播时延。

??? tip "answer"
    发送时延 = $\frac{100MB}{1Mb/s} = \frac{100 \times 2^{20}}{10^6} s \approx 104.86 s$

    传播时延 = $\frac{1000KM}{2 \times 10^8 m/s} = \frac{1000 \times 10^3}{2 \times 10^8} s = 5 ms$

???+ example
    数据块长度为1B，信道带宽为1Mb/s，传送距离为1000KM，传输介质为光纤，计算发送时延和传播时延。
    
??? tip "answer"
    发送时延 = $\frac{1B}{1Mb/s} = \frac{1}{10^6} s = 10^{-6} s$

    传播时延 = $\frac{1000KM}{2 \times 10^8 m/s} = \frac{1000 \times 10^3}{2 \times 10^8} s = 5ms$

---

### 时延带宽积

指发送端发送的第一个比特即将到达终点时，发送端已发出了多少比特，也称以比特为单位的链路长度，即:

$$\text{时延带宽积=传播时延x信道带宽}$$

![img](./assets/1-16.png)

???+ example
    主机A和B之间采用光纤链路，链路长1km，链路带宽为1Gb/s，请计算该链路的时延带宽积。

??? tip "answer"
    时延带宽积 = $\frac{1km}{2 \times 10^8 m/s} \times 1 \times 10^9 b/s = 5000 b$

---

### 往返时延(Round-Trip Time，RTT)

指从发送端发出一个短分组，到发送端收到来自接收端的确认(接收端收到数据后立即发送确认)总共经历的时间。在互联网中，往返时延还包括各中间节点的处理时延、排队时延及转发数据时的发送时延。

---

### 信道利用率

用来指出某个信道有百分之多少的时间是有数据通过的。

$$\text{信道利用率}=\frac{\text{有数据通过的时间}}{\text{有数据通过的时间}+\text{无数据通过的时间}}$$

信道利用率并非越高越好，信道利用率太低会浪费网络资源;信道利用率太高会产生较大的时延，导致网络拥塞。这就好比当公路上的车流量很大时，容易出现拥堵。

---