
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="央央的笔记本">
      
      
      
        <link rel="canonical" href="https://melody12020831.github.io/Notebook/Computer_Science/DB/Chapter15/">
      
      
        <link rel="prev" href="../Chapter14/">
      
      
        <link rel="next" href="../Chapter16/">
      
      
      <link rel="icon" href="../../../assets/images/icon.jpg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Chapter 15 | Query Processing - 央央's Notebook</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
      <link rel="stylesheet" href="../../../css/card.css">
    
      <link rel="stylesheet" href="../../../css/tasklist.css">
    
      <link rel="stylesheet" href="../../../css/flink.css">
    
      <link rel="stylesheet" href="../../../css/more_changelog.css">
    
      <link rel="stylesheet" href="../../../css/neoteroi-mkdocs.css">
    
      <link rel="stylesheet" href="../../../css/fold_toc.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-002T22X4FB"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-002T22X4FB",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-002T22X4FB",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-15-query-processing" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="央央&#39;s Notebook" class="md-header__button md-logo" aria-label="央央's Notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            央央's Notebook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 15 | Query Processing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Melody12020831/Notebook/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Melody
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Computer Science

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Math/" class="md-tabs__link">
          
  
  
    
  
  Math

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Miscellaneous/" class="md-tabs__link">
          
  
  
    
  
  Misccelleanous

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="央央&#39;s Notebook" class="md-nav__button md-logo" aria-label="央央's Notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg>

    </a>
    央央's Notebook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Melody12020831/Notebook/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Melody
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Computer Science
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computer Science
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ADS/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ADS
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            ADS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/Homework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Homework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/organisedproblems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Organisedproblems
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CO/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CO
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            CO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/Chapter%201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/Chapter%202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/Chapter%203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/Chapter%204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/Chapter%205/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    chapter 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/Chapter%206/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/COhomework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CO homework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/PPT_download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    DB
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            DB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1 | Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 2 | Introduction to the Relational Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 3 | Introduction to SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 4 | Intermediate SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 5 | Advanced SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 6 | Entity-Relationship Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 7 | Relational Database Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 8 | Complex Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 12 | Physical Storage Systems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 13 | Data Storage Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 14 | Indexing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Chapter 15 | Query Processing
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Chapter 15 | Query Processing
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basic-steps-in-query-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Steps in Query Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#measures-of-query-cost" class="md-nav__link">
    <span class="md-ellipsis">
      Measures of Query Cost
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Measures of Query Cost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selection-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Selection Operation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Selection Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-scan-algorithm-a1-linear-search" class="md-nav__link">
    <span class="md-ellipsis">
      File scan / Algorithm A1 (linear search).
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index-scan-a2-primary-b-tree-index-clustering-b-tree-index-equality-on-key" class="md-nav__link">
    <span class="md-ellipsis">
      Index scan / A2 (primary B+-tree index / clustering B+-tree index, equality on key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a3-primary-b-tree-index-clustering-b-tree-index-equality-on-nonkey" class="md-nav__link">
    <span class="md-ellipsis">
      A3 (primary B+-tree index/ clustering B+-tree index, equality on nonkey)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a4-secondary-b-tree-index-equality-on-key" class="md-nav__link">
    <span class="md-ellipsis">
      A4 (secondary B+-tree index , equality on key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a4-secondary-b-index-on-nonkey-equality" class="md-nav__link">
    <span class="md-ellipsis">
      A4' (secondary B+-index on nonkey, equality)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a5-primary-b-index-clustering-b-index-index-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      A5 (primary B+-index / clustering B+-index index, comparison)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a6-secondary-b-tree-index-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      A6 (secondary B+-tree index, comparison)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a7-conjunctive-selection-using-one-index" class="md-nav__link">
    <span class="md-ellipsis">
      A7 (conjunctive selection using one index)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a8-conjunctive-selection-using-composite-index" class="md-nav__link">
    <span class="md-ellipsis">
      A8 (conjunctive selection using composite index)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a9-conjunctive-selection-by-intersection-of-identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      A9 (conjunctive selection by intersection of identifiers)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a10-disjunctive-selection-by-union-of-identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      A10 (disjunctive selection by union of identifiers)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    <span class="md-ellipsis">
      Sorting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sorting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#external-sort-merge" class="md-nav__link">
    <span class="md-ellipsis">
      External Sort-Merge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External Sort-Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cost-analysis-simple-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost analysis: (simple version)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-of-seeks-simple-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost of seeks: (simple version)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-analysis-advanced-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost analysis: (advanced version)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-of-seeks-advanced-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost of seeks: (advanced version)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Join Operation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Join Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Block Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-join" class="md-nav__link">
    <span class="md-ellipsis">
      Merge-Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash-join" class="md-nav__link">
    <span class="md-ellipsis">
      Hash-Join
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hash-Join">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hash-join-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Hash-Join Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-of-hash-join" class="md-nav__link">
    <span class="md-ellipsis">
      Cost of Hash-Join
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Other Operations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-of-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluation of Expressions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation of Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#materialization" class="md-nav__link">
    <span class="md-ellipsis">
      Materialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipelining" class="md-nav__link">
    <span class="md-ellipsis">
      Pipelining
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 16 | Query Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 17 | Transactions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 18 | Concurrency Control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 19 | Recovery System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Homework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL learning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../OOP/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    OOP
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            OOP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1 | introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 2 | A tour of cpp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 3 | STL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 4 | Memory Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 5 | Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 6 | Ctor/Dtor &amp;&amp; Composition &amp; Inheritance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 7 | Polymorphism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 8 | Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 9 | Copy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 10 | Operator Overloading &amp;&amp; Streams
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 11 | templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 12 | Iterators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 13 | Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 14 | Smart Pointers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/Chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 15 | Miscellaneous Topics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/homework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Homework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/test_from_wk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WK's 课前小测
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OOP/105_STL_Algorithmsin_Less_Than_an_Hour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    105 STL Algorithmsin Less Than an Hour
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CA
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            CA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/Chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ch1 | Fundamentals of Computer Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/Chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ch2 | Memory Hierarchy Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/homework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Homework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CA/CA_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../TOC/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    TOC
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            TOC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TOC/Chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Visualization/note/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据可视化笔记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    编程语言
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            编程语言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Programming_Language/python/CS50P_python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Programming_Language/python/python100days/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python-100-Days
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/reveal-md/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    使用 reveal-md 制作 PPT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Math/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Math
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    概率论与数理统计
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            概率论与数理统计
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1 概率论的基本概念
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 2 随机变量及其分布
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 3 多元随机变量及其分布
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 4 随机变量的数字特征
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 5 大数定律和中心极限定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 6 数理统计的基本概念
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 7 参数估计
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/Chapter8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 8 假设检验
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/PPT_download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_11" >
        
          
          <label class="md-nav__link" for="__nav_3_2_11" id="__nav_3_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Homework
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_11">
            <span class="md-nav__icon md-icon"></span>
            Homework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/Homework_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Homework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW1(习题一)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW2(习题一)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW3(习题一、二)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW4(习题二)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW5(习题二、三)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW6(习题三)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW7(习题三)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW8(习题四)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW9(习题四、五)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW10(习题五、六)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW11(习题六、七(只计算矩估计))
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW12(习题七)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW13(习题七)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Math/Probability_Theory_and_Mathematical_Statistics/HW/HW14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW14(习题八)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Miscellaneous/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Misccelleanous
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Misccelleanous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Miscellaneous/prompt/prompt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Miscellaneous/mermaid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mermaid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UBC
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            UBC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Miscellaneous/UBC/UBC%20summer%20institute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    block chain DAY 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Miscellaneous/UBC/download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basic-steps-in-query-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Steps in Query Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#measures-of-query-cost" class="md-nav__link">
    <span class="md-ellipsis">
      Measures of Query Cost
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Measures of Query Cost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selection-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Selection Operation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Selection Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-scan-algorithm-a1-linear-search" class="md-nav__link">
    <span class="md-ellipsis">
      File scan / Algorithm A1 (linear search).
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index-scan-a2-primary-b-tree-index-clustering-b-tree-index-equality-on-key" class="md-nav__link">
    <span class="md-ellipsis">
      Index scan / A2 (primary B+-tree index / clustering B+-tree index, equality on key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a3-primary-b-tree-index-clustering-b-tree-index-equality-on-nonkey" class="md-nav__link">
    <span class="md-ellipsis">
      A3 (primary B+-tree index/ clustering B+-tree index, equality on nonkey)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a4-secondary-b-tree-index-equality-on-key" class="md-nav__link">
    <span class="md-ellipsis">
      A4 (secondary B+-tree index , equality on key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a4-secondary-b-index-on-nonkey-equality" class="md-nav__link">
    <span class="md-ellipsis">
      A4' (secondary B+-index on nonkey, equality)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a5-primary-b-index-clustering-b-index-index-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      A5 (primary B+-index / clustering B+-index index, comparison)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a6-secondary-b-tree-index-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      A6 (secondary B+-tree index, comparison)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a7-conjunctive-selection-using-one-index" class="md-nav__link">
    <span class="md-ellipsis">
      A7 (conjunctive selection using one index)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a8-conjunctive-selection-using-composite-index" class="md-nav__link">
    <span class="md-ellipsis">
      A8 (conjunctive selection using composite index)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a9-conjunctive-selection-by-intersection-of-identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      A9 (conjunctive selection by intersection of identifiers)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a10-disjunctive-selection-by-union-of-identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      A10 (disjunctive selection by union of identifiers)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    <span class="md-ellipsis">
      Sorting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sorting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#external-sort-merge" class="md-nav__link">
    <span class="md-ellipsis">
      External Sort-Merge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External Sort-Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cost-analysis-simple-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost analysis: (simple version)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-of-seeks-simple-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost of seeks: (simple version)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-analysis-advanced-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost analysis: (advanced version)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-of-seeks-advanced-version" class="md-nav__link">
    <span class="md-ellipsis">
      Cost of seeks: (advanced version)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Join Operation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Join Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Block Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-join" class="md-nav__link">
    <span class="md-ellipsis">
      Merge-Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash-join" class="md-nav__link">
    <span class="md-ellipsis">
      Hash-Join
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hash-Join">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hash-join-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Hash-Join Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-of-hash-join" class="md-nav__link">
    <span class="md-ellipsis">
      Cost of Hash-Join
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Other Operations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-of-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluation of Expressions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation of Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#materialization" class="md-nav__link">
    <span class="md-ellipsis">
      Materialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipelining" class="md-nav__link">
    <span class="md-ellipsis">
      Pipelining
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="chapter-15-query-processing">Chapter 15 | Query Processing<a class="headerlink" href="#chapter-15-query-processing" title="Permanent link">&para;</a></h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 11825 个字 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 6 行代码 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 31 张图片 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 59 分钟</p>
</div>
<h2 id="basic-steps-in-query-processing">Basic Steps in Query Processing<a class="headerlink" href="#basic-steps-in-query-processing" title="Permanent link">&para;</a></h2>
<p>The steps involved in processing a query appear in Figure 15.1. The basic steps are:</p>
<ol>
<li>Parsing and translation. 语法分析与翻译</li>
</ol>
<p>translate the query into its internal form. This is then translated into relational algebra.</p>
<p>Parser checks syntax, verifies relations</p>
<ol start="2">
<li>Optimization. 优化</li>
</ol>
<p>Amongst all equivalent evaluation plans choose the one with lowest cost.</p>
<ol start="3">
<li>Evaluation. 执行</li>
</ol>
<p>The query-execution engine takes a query-evaluation plan, executes that plan, and returns the answers to the query.</p>
<p><a class="glightbox" href="../assets/15-1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-1.png" /></a></p>
<p>An evaluation plan defines exactly what algorithm is used for each operation, and how the execution of the operations is coordinated.</p>
<p>为了全面说明如何执行一个查询，我们不仅要提供关系代数表达式，还要对表达式加上带指令的注释来说明如何执行每种运算。</p>
<p>这些注释可以说明为一种具体运算所采用的算法或要使用的一个具体索引或多个索引。带有"如何执行"注释的关系代数运算称为执行原语(evaluation primitive)。用于执行一个查询的原语操作序列称为查询执行计划(query-execution plan或 query-evaluation plan)。</p>
<p>查询执行引擎(query-execution engine)接受一个查询执行计划，执行该计划并把结果返回给查询。</p>
<p><a class="glightbox" href="../assets/15-2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-2.png" /></a></p>
<details class="note">
<summary>sjl's explanation</summary>
<ol>
<li>
<p>选择运算到叶子上面，早点执行</p>
</li>
<li>
<p>hash join 把哈希值相同的放在一起</p>
</li>
<li>
<p>这个算子生成一个临时表，两个临时表连接再存储... 因为要把中间结果存储起来，写回去再读出来，会比较低效</p>
</li>
<li>
<p>可以采用流水线的思想，因为磁盘的读写是时间的大头</p>
</li>
</ol>
</details>
<hr />
<h2 id="measures-of-query-cost">Measures of Query Cost<a class="headerlink" href="#measures-of-query-cost" title="Permanent link">&para;</a></h2>
<p><a class="glightbox" href="../assets/15-21.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-21.png" /></a></p>
<details class="note">
<summary>about 聚集索引和辅助索引</summary>
<p>假设我们有一个 <code>students</code> 表，存储学生的信息，结构如下：</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><strong>学号（sid）</strong></th>
<th style="text-align: center;"><strong>姓名（name）</strong></th>
<th style="text-align: center;"><strong>年龄（age）</strong></th>
<th style="text-align: center;"><strong>班级（class）</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">101</td>
<td style="text-align: center;">张三</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">1班</td>
</tr>
<tr>
<td style="text-align: center;">102</td>
<td style="text-align: center;">李四</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">2班</td>
</tr>
<tr>
<td style="text-align: center;">103</td>
<td style="text-align: center;">王五</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">1班</td>
</tr>
<tr>
<td style="text-align: center;">104</td>
<td style="text-align: center;">赵六</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">3班</td>
</tr>
</tbody>
</table>
<ol>
<li>聚集索引（Clustered Index）</li>
</ol>
<p>在 MySQL InnoDB 中，<strong>主键默认是聚集索引</strong>。假设我们以 <code>学号（sid）</code> 作为主键，那么数据行在磁盘上<strong>按 <code>学号</code> 顺序存储</strong>。</p>
<p><strong>B+树结构</strong>：</p>
<ul>
<li><strong>叶子节点</strong>：存储<strong>完整的数据行</strong>（<code>sid, name, age, class</code>）。</li>
<li><strong>非叶子节点</strong>：存储键值（<code>sid</code>）和指向下一层的指针。</li>
</ul>
<ol start="2">
<li>辅助索引（Secondary Index）</li>
</ol>
<p>假设我们在 <code>姓名（name）</code> 字段上创建一个辅助索引，辅助索引的 B+树<strong>独立于数据存储</strong>，叶子节点不存完整数据，而是存<strong>主键值（sid）</strong>。</p>
<p><strong>B+树结构</strong>：</p>
<ul>
<li><strong>叶子节点</strong>：存储 <code>name</code> 和对应的 <code>sid</code>（如 <code>('张三', 101)</code>）。</li>
<li><strong>非叶子节点</strong>：存储 <code>name</code> 和指向下一层的指针。</li>
</ul>
<p><strong>关键区别对比</strong></p>
<table>
<thead>
<tr>
<th style="text-align: center;"><strong>查询场景</strong></th>
<th style="text-align: center;"><strong>聚集索引（sid）</strong></th>
<th style="text-align: center;"><strong>辅助索引（name）</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><strong>查询 <code>WHERE sid=102</code></strong></td>
<td style="text-align: center;">直接定位数据行，<strong>无需回表</strong>，速度快。</td>
<td style="text-align: center;">不适用（除非覆盖索引）。</td>
</tr>
<tr>
<td style="text-align: center;"><strong>查询 <code>WHERE name='李四'</code></strong></td>
<td style="text-align: center;">需全表扫描（除非优化器选择索引）。</td>
<td style="text-align: center;">先查 <code>name</code> 索引得 <code>sid</code>，再回表，<strong>多一步</strong>。</td>
</tr>
<tr>
<td style="text-align: center;"><strong>插入数据</strong></td>
<td style="text-align: center;">数据按 <code>sid</code> 排序插入，可能引起页分裂。</td>
<td style="text-align: center;">只需更新 <code>name</code> 索引树，不影响数据物理顺序。</td>
</tr>
</tbody>
</table>
</details>
<hr />
<p>Cost is generally measured as total elapsed time for answering query</p>
<p>Typically disk access is the predominant cost, and is also relatively easy to estimate.</p>
<p>Measured by taking into account</p>
<ul>
<li>Number of seeks</li>
<li>Number of blocks read</li>
<li>Number of blocks written</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Cost to write a block is greater than cost to read a block.</p>
<p>data is read back after being written to ensure that the write was successful</p>
</div>
<p>For simplicity we just use the number of <strong>block transfers from disk</strong> and the number of <strong>seeks</strong> as the cost measures</p>
<ul>
<li><span class="arithmatex">\(t_T\)</span> ——time to transfer one block</li>
<li><span class="arithmatex">\(t_S\)</span> ——time for one seek</li>
<li>Cost for b block transfers plus S seeks is <span class="arithmatex">\(b \cdot t_T + S \cdot t_S\)</span></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="arithmatex">\(t_S\)</span> and <span class="arithmatex">\(t_T\)</span> depend on where data is stored; with 4 KB blocks:</p>
<p>High end magnetic disk: <span class="arithmatex">\(t_S = 4\)</span> msec, <span class="arithmatex">\(t_T = 0.1\)</span> msec, <span class="arithmatex">\(t_S / t_T \approx 40\)</span></p>
<p>SSD: <span class="arithmatex">\(t_S\)</span> = 20-90 microsec and <span class="arithmatex">\(t_T\)</span> = 2-10 microsec for 4KB, <span class="arithmatex">\(t_S / t_T \approx 10\)</span></p>
</div>
<p>We ignore CPU costs for simplicity, while real systems do take CPU cost into account.</p>
<p>We ignore cost to writing output to disk in our cost formulae.</p>
<p>Several algorithms can reduce disk IO by using extra buffer space </p>
<p>Amount of real memory available to buffer depends on other concurrent queries and OS processes, known only during execution. We often use worst case estimates, assuming only the minimum amount of memory needed for the operation is available.</p>
<p>Required data may be buffer resident already, avoiding disk I/O. But hard to take into account for cost estimation.</p>
<hr />
<h3 id="selection-operation">Selection Operation<a class="headerlink" href="#selection-operation" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../assets/15-3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-3.png" /></a></p>
<h4 id="file-scan-algorithm-a1-linear-search">File scan / Algorithm A1 (linear search).<a class="headerlink" href="#file-scan-algorithm-a1-linear-search" title="Permanent link">&para;</a></h4>
<p>Scan each file block and test all records to see whether they satisfy the selection condition.</p>
<p>worst cost = <span class="arithmatex">\(b_r \times t_T + t_S\)</span></p>
<ul>
<li><span class="arithmatex">\(b_r\)</span> denotes number of blocks containing records from relation r</li>
</ul>
<p>If selection is on a key attribute, can stop on finding record</p>
<p>average cost = <span class="arithmatex">\((\frac{b_r}{2}) \times t_T + t_S\)</span></p>
<p>Linear search can be applied regardless of</p>
<ul>
<li>selection condition or</li>
<li>ordering of records in the file, or</li>
<li>availability of indices</li>
</ul>
<p><strong>Note</strong>: binary search generally does not make sense since data is not stored consecutively, except when there is an index available, and binary search requires more seeks than index search.</p>
<hr />
<h4 id="index-scan-a2-primary-b-tree-index-clustering-b-tree-index-equality-on-key">Index scan / A2 (primary B+-tree index / clustering B+-tree index, equality on key)<a class="headerlink" href="#index-scan-a2-primary-b-tree-index-clustering-b-tree-index-equality-on-key" title="Permanent link">&para;</a></h4>
<p>Index scan – search algorithms that use an index selection condition must be on search-key of index.</p>
<p>Retrieve a single record that satisfies the corresponding equality condition</p>
<p>Cost = <span class="arithmatex">\((h_i + 1) \times (t_S + t_T)\)</span></p>
<p><a class="glightbox" href="../assets/15-4.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-4.png" /></a></p>
<hr />
<h4 id="a3-primary-b-tree-index-clustering-b-tree-index-equality-on-nonkey">A3 (primary B+-tree index/ clustering B+-tree index, equality on nonkey)<a class="headerlink" href="#a3-primary-b-tree-index-clustering-b-tree-index-equality-on-nonkey" title="Permanent link">&para;</a></h4>
<p>Retrieve multiple records.</p>
<p>Records will be on consecutive blocks.</p>
<p>Let b = number of blocks containing matching records</p>
<p>Cost = <span class="arithmatex">\(h_i \times (t_T + t_S) + t_S + t_T \times b\)</span></p>
<p><a class="glightbox" href="../assets/15-5.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-5.png" /></a></p>
<hr />
<h4 id="a4-secondary-b-tree-index-equality-on-key">A4 (secondary B+-tree index , equality on key)<a class="headerlink" href="#a4-secondary-b-tree-index-equality-on-key" title="Permanent link">&para;</a></h4>
<p>Cost = <span class="arithmatex">\((h_i + 1) \times (t_S + t_T)\)</span></p>
<p><a class="glightbox" href="../assets/15-6.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-6.png" /></a></p>
<hr />
<h4 id="a4-secondary-b-index-on-nonkey-equality">A4' (secondary B+-index on nonkey, equality)<a class="headerlink" href="#a4-secondary-b-index-on-nonkey-equality" title="Permanent link">&para;</a></h4>
<p>Each of n matching records may be on a different block</p>
<p>n pointers may be stored in m blocks</p>
<p>Cost = <span class="arithmatex">\((h_i + m + n) \times (t_S + t_T)\)</span></p>
<p>Can be very expensive!</p>
<p><a class="glightbox" href="../assets/15-7.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-7.png" /></a></p>
<hr />
<p>Can implement selections of the form <span class="arithmatex">\(\sigma_{A \le V}(r)\)</span> or <span class="arithmatex">\(\sigma_{A \ge V}(r)\)</span> by using</p>
<p>a linear file scan or binary search, or by using indices in the following ways:</p>
<h4 id="a5-primary-b-index-clustering-b-index-index-comparison">A5 (primary B+-index / clustering B+-index index, comparison)<a class="headerlink" href="#a5-primary-b-index-clustering-b-index-index-comparison" title="Permanent link">&para;</a></h4>
<p>(Relation is sorted on A)</p>
<ul>
<li>For <span class="arithmatex">\(\sigma_{A \ge V}(r)\)</span> use index to find first tuple <span class="arithmatex">\(\ge V\)</span> and scan relation sequentially from there.</li>
<li>Cost is identical to the case of A3 <span class="arithmatex">\(\rightarrow \ Cost \ = \ h_i \times (t_T + t_S) + t_S + t_T \times b\)</span></li>
<li>For <span class="arithmatex">\(\sigma_{A \le V}(r)\)</span> just scan relation sequentially till first tuple &gt; V; do not use index</li>
</ul>
<p><a class="glightbox" href="../assets/15-8.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-8.png" /></a></p>
<hr />
<h4 id="a6-secondary-b-tree-index-comparison">A6 (secondary B+-tree index, comparison)<a class="headerlink" href="#a6-secondary-b-tree-index-comparison" title="Permanent link">&para;</a></h4>
<ul>
<li>For <span class="arithmatex">\(\sigma_{A \ge V}(r)\)</span> use index to find first ndex entry <span class="arithmatex">\(\ge V\)</span> and scan index sequentially from there, to find pointers to records.</li>
<li>For <span class="arithmatex">\(\sigma_{A \le V}(r)\)</span> just scan eaf pages of index finding pointers to records, till first entry &gt; V.</li>
<li>In either case, retrieve records that are pointed to<ul>
<li>requires an I/O for each record</li>
<li>Linear file scan may be cheaper</li>
</ul>
</li>
</ul>
<p><a class="glightbox" href="../assets/15-9.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-9.png" /></a></p>
<hr />
<p>Conjunction: <span class="arithmatex">\(\sigma_{\theta_1 \land \theta_2 \land \ldots \land \theta_n}(r)\)</span></p>
<h4 id="a7-conjunctive-selection-using-one-index">A7 (conjunctive selection using one index)<a class="headerlink" href="#a7-conjunctive-selection-using-one-index" title="Permanent link">&para;</a></h4>
<p>Select a combination of <span class="arithmatex">\(\theta_i\)</span> and algorithms A1 through A6 that results in the least cost for <span class="arithmatex">\(\sigma_{\theta_i}(r)\)</span></p>
<p>Test other conditions on tuple after fetching it into memory buffer.</p>
<hr />
<h4 id="a8-conjunctive-selection-using-composite-index">A8 (conjunctive selection using composite index)<a class="headerlink" href="#a8-conjunctive-selection-using-composite-index" title="Permanent link">&para;</a></h4>
<p>Use appropriate composite (multiple-key) index if available</p>
<hr />
<h4 id="a9-conjunctive-selection-by-intersection-of-identifiers">A9 (conjunctive selection by intersection of identifiers)<a class="headerlink" href="#a9-conjunctive-selection-by-intersection-of-identifiers" title="Permanent link">&para;</a></h4>
<p>Requires indices with record pointers.</p>
<p>Use corresponding index for each condition, and take intersection 
of all the obtained sets of record pointers. </p>
<p>Then fetch records from file.</p>
<p>If some conditions do not have appropriate indices, apply test in 
memory.</p>
<hr />
<p>Disjunction: <span class="arithmatex">\(\sigma_{\theta_1 \lor \theta_2 \lor \ldots \lor \theta_n}(r)\)</span></p>
<h4 id="a10-disjunctive-selection-by-union-of-identifiers">A10 (disjunctive selection by union of identifiers)<a class="headerlink" href="#a10-disjunctive-selection-by-union-of-identifiers" title="Permanent link">&para;</a></h4>
<p>Applicable if all conditions have available indices. Otherwise use linear scan.</p>
<p>Use corresponding index for each condition, and take union of all the obtained sets of record pointers.</p>
<p>Then fetch records from file</p>
<hr />
<p>Negation: <span class="arithmatex">\(\sigma_{\neg \theta}(r)\)</span></p>
<p>Use linear scan on file</p>
<p>If very few records satisfy <span class="arithmatex">\(\neg \theta\)</span> , and an index is applicable to <span class="arithmatex">\(\theta\)</span> , find satisfying records using index and fetch from file</p>
<hr />
<h2 id="sorting">Sorting<a class="headerlink" href="#sorting" title="Permanent link">&para;</a></h2>
<p>We may build an index on the relation, and then use the index to read the relation in sorted order. May lead to one disk block access for each tuple.</p>
<p>For relations that fit in memory, techniques like quicksort can be used. </p>
<p>For relations that don’t fit in memory, external sort-merge is a good choice.</p>
<hr />
<h3 id="external-sort-merge">External Sort-Merge<a class="headerlink" href="#external-sort-merge" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../assets/15-10.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-10.png" /></a></p>
<p>Let M denote memory size (in pages).</p>
<ol>
<li>Create sorted runs (归并段).</li>
</ol>
<p>Let i be 0 initially.</p>
<p>Repeatedly do the following till the end of the relation:</p>
<p>(a) Read M blocks of relation into memory</p>
<p>(b) Sort the in-memory blocks</p>
<p>(c) Write sorted data to run <span class="arithmatex">\(R_i\)</span> ; increment i.</p>
<p>Let the final value of i be N</p>
<hr />
<ol start="2">
<li>Merge the runs (N-way merge).</li>
</ol>
<p>If N &lt; M, single merge pass is required (如果归并段少于可用内存页)</p>
<p>a. Use N blocks of memory to buffer input runs, and 1 block to buffer output. Read the first block of each run into its buffer page</p>
<p>b. repeat</p>
<div class="highlight"><pre><span></span><code>(1) Select the first record (in sort order) among all buffer pages

(2) Write the record to the output buffer. If the output buffer is full write it to disk.

(3) Delete the record from its input buffer page. If the buffer page becomes empty then read the next block (if any) of the run into the buffer.
</code></pre></div>
<p>c. until all input buffer pages are empty:</p>
<p><a class="glightbox" href="../assets/15-11.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-11.png" /></a></p>
<hr />
<p>If N <span class="arithmatex">\(\ge\)</span> M, several merge passes are required.</p>
<p>In each pass, contiguous groups of M - 1 runs are merged.</p>
<p>A pass reduces the number of runs by a factor of M -1, and creates runs longer by the same factor.</p>
<ul>
<li>E.g. If M=11, and there are 90 runs, one pass reduces the number of runs to 9, each 10 times the size of the initial runs</li>
</ul>
<p>Repeated passes are performed till all runs have been merged into one.</p>
<hr />
<h4 id="cost-analysis-simple-version"><strong>Cost analysis</strong>: (simple version)<a class="headerlink" href="#cost-analysis-simple-version" title="Permanent link">&para;</a></h4>
<p>Total number of runs : <span class="arithmatex">\(\lceil b_r / M \rceil\)</span></p>
<p>Total number of merge passes required: <span class="arithmatex">\(\lceil \log_{M-1} (b_r / M) \rceil\)</span></p>
<p>Block transfers for initial run creation as well as in each pass is <span class="arithmatex">\(2b_r\)</span></p>
<p>For final pass, we don’t count write cost. We ignore final write cost for all operations since the output of an operation may be sent to the parent operation without being written to disk.</p>
<p>Thus total number of block transfers for external sorting:</p>
<div class="arithmatex">\[2b_r \lceil \log_{M-1} (b_r / M) \rceil + b_r = b_r(2 \lceil \log_{M-1} (b_r / M) \rceil + 1)\]</div>
<details class="note">
<summary>解释</summary>
<p>这里的 <span class="arithmatex">\(b_r\)</span> 指的是关系（即要排序的文件）所占用的总块数。</p>
<p>我们把这个过程分解成两个阶段来解释：</p>
<p>阶段一：初始顺串的生成 (Initial Run Creation)</p>
<p>这是外排序算法的第一步。目标是将一个巨大的、无序的文件，转换成多个小的、内部有序的文件片段，我们称之为顺串 (runs)。</p>
<p>这个过程如下：</p>
<ol>
<li><strong>读入 (Read)</strong>：算法从磁盘上读取数据块，直到把分配的内存 (<span class="arithmatex">\(M\)</span> 块) 填满。</li>
<li><strong>排序 (Sort)</strong>：在内存中，使用快速排序等高效的内排序算法，对这 <span class="arithmatex">\(M\)</span> 块数据进行排序。</li>
<li><strong>写出 (Write)</strong>：将排序好的这 <span class="arithmatex">\(M\)</span> 块数据，作为一个有序的顺串，写回到磁盘上。这个顺串是一个临时文件。</li>
<li><strong>重复</strong>：重复以上 1-3 步，直到原始文件的所有数据块都被处理完毕。</li>
</ol>
<p><strong>成本分析：</strong></p>
<ul>
<li><strong>总读取成本</strong>：为了生成这些顺串，算法必须把原始文件的<strong>每一个块</strong>都从磁盘读入内存一次。因此，总的读取成本是 <span class="arithmatex">\(b_r\)</span> 次块传输。</li>
<li><strong>总写出成本</strong>：同样，被读入内存并排序好的<strong>每一个块</strong>，都必须被重新写回到磁盘，形成临时的顺串文件。因此，总的写出成本也是 <span class="arithmatex">\(b_r\)</span> 次块传输。</li>
</ul>
<p><strong>阶段一总成本 = 读取成本 (<span class="arithmatex">\(b_r\)</span>) + 写出成本 (<span class="arithmatex">\(b_r\)</span>) = <span class="arithmatex">\(2b_r\)</span></strong></p>
<p>阶段二：每一个合并趟数 (Each Merge Pass)</p>
<p>在第一阶段之后，我们得到了一堆数量为 <span class="arithmatex">\(\lceil b_r / M \rceil\)</span> 的、各自有序但全局无序的顺串。第二阶段的目标就是把这些顺串合并成一个最终的、完全有序的文件。</p>
<p>因为内存有限，我们无法一次性合并所有的顺串，所以需要分趟 (pass) 进行。</p>
<p>在一个<strong>完整的合并趟数</strong>中，过程如下：</p>
<ol>
<li><strong>读入 (Read)</strong>：算法从磁盘上读取上一趟生成的各个顺串的第一个块，放入内存中的<strong>输入缓冲区</strong>。</li>
<li><strong>合并 (Merge)</strong>：在内存中，比较各个输入缓冲区的当前最小元素，将最小的那个放入<strong>输出缓冲区</strong>。然后从被选中的那个输入缓冲区补充下一个元素。如果某个输入缓冲区空了，就从对应的磁盘顺串中再读取一个块进来。</li>
<li><strong>写出 (Write)</strong>：当输出缓冲区满了，就将其内容作为一个新的、更长的顺串写回到磁盘上。</li>
<li><strong>重复</strong>：重复以上 1-3 步，直到这一趟要处理的所有顺串都被完全读取和合并，并写成新一批数量更少、但长度更长的顺串。</li>
</ol>
<p><strong>成本分析：</strong></p>
<ul>
<li><strong>总读取成本</strong>：在一个完整的合并趟数中，为了生成下一代更长的顺串，算法必须把上一趟产生的所有顺串的<strong>每一个块</strong>都从磁盘读入内存一次。因此，总的读取成本是 <span class="arithmatex">\(b_r\)</span> 次块传输。</li>
<li><strong>总写出成本</strong>：同样，合并后产生的新的、更长的顺串的<strong>每一个块</strong>，都必须被写回到磁盘，为下一趟合并做准备。因此，总的写出成本也是 <span class="arithmatex">\(b_r\)</span> 次块传输。</li>
</ul>
<p><strong>一个合并趟数的总成本 = 读取成本 (<span class="arithmatex">\(b_r\)</span>) + 写出成本 (<span class="arithmatex">\(b_r\)</span>) = <span class="arithmatex">\(2b_r\)</span></strong></p>
<blockquote>
<p><strong>注意</strong>：这是因为在<strong>最后一次</strong>合并时，最终的排序结果可以直接作为输出流向下一个操作（例如，直接显示给用户或进行聚合计算），而无需再写回磁盘。所以，除了最后一趟，中间的每一趟合并成本都是 <span class="arithmatex">\(2b_r\)</span>。</p>
</blockquote>
</details>
<hr />
<h4 id="cost-of-seeks-simple-version"><strong>Cost of seeks</strong>: (simple version)<a class="headerlink" href="#cost-of-seeks-simple-version" title="Permanent link">&para;</a></h4>
<p>During run generation: one seek to read each run and one seek to write each run</p>
<ul>
<li><span class="arithmatex">\(2 \lceil b_r / M \rceil \rightarrow 2 \times [\text{the number of runs}]\)</span></li>
</ul>
<p>During the merge phase</p>
<p>Need 2 <span class="arithmatex">\(b_r\)</span> seeks for each merge pass, except the final one which does not require a write</p>
<p>There are <span class="arithmatex">\(\lceil \log_{M-1} (b_r / M) \rceil\)</span> merge passes</p>
<p>Total number of seeks:</p>
<div class="arithmatex">\[2 \lceil b_r / M \rceil + b_r(2 \lceil \log_{M-1} (b_r / M) \rceil - 1)\]</div>
<details class="note">
<summary>解释</summary>
<p>首先，我们要理解一个核心概念：
<strong>寻道 (Seek)</strong>：在机械硬盘上，这是指将磁盘的读写磁头移动到正确磁道所需的时间。这是一个物理动作，速度很慢，通常是I/O操作中最耗时的部分之一。因此，在数据库性能分析中，<strong>最小化寻道次数</strong>是一个至关重要的优化目标。</p>
<p>这个公式将总寻道成本分为了两个独立的部分：<strong>初始顺串生成阶段</strong>和<strong>多趟合并阶段</strong>。</p>
<p>第一部分：初始顺串生成阶段的寻道成本</p>
<ol>
<li>
<p>我们把大文件（大小为 <span class="arithmatex">\(b_r\)</span> 块）分成小块（每块大小为内存大小 <span class="arithmatex">\(M\)</span>），在内存中排序后，写回磁盘形成一个有序的临时文件，这个文件就是一个顺串(run)。</p>
</li>
<li>
<p>这个模型做了一个简化的假设：</p>
<ul>
<li><strong>读 (Read)</strong>：为了从原始文件中读取下一个 <span class="arithmatex">\(M\)</span> 大小的数据块，磁头需要<strong>寻道</strong>到这个数据块的起始位置。这算 <strong>1次寻道</strong>。</li>
<li><strong>写 (Write)</strong>：当这 <span class="arithmatex">\(M\)</span> 块数据在内存中排好序后，需要把它写到磁盘上的一个新位置（作为一个新的临时文件）。操作系统需要为这个新文件找到空间，这需要磁头<strong>寻道</strong>到那个位置开始写入。这算 <strong>1次寻道</strong>。
因此，每生成一个顺串，都伴随着 <code>1次读寻道 + 1次写寻道 = 2次寻道</code>。</li>
</ul>
</li>
<li>
<p>文件的总大小是 <span class="arithmatex">\(b_r\)</span> 块，每次处理 <span class="arithmatex">\(M\)</span> 块，所以生成的顺串总数是 <span class="arithmatex">\(\lceil b_r / M \rceil\)</span>。</p>
</li>
<li>
<p>总寻道次数 = (每个顺串的寻道次数) × (顺串的总数) = <span class="arithmatex">\(2 \times \lceil b_r / M \rceil\)</span>。</p>
</li>
</ol>
<p>第二部分：合并阶段的寻道成本</p>
<ol>
<li>
<p>这是 <strong>Simple Version 模型的一个非常重要的、悲观的（worst-case）假设</strong>。它假设：</p>
<ul>
<li><strong>读 (Read)</strong>：在合并阶段，我们需要同时从多个（最多 <span class="arithmatex">\(M-1\)</span> 个）不同的顺串文件中读取数据。这个模型假设这些文件在磁盘上是完全随机分布的。因此，每当需要从任何一个顺串读取<strong>一个数据块</strong>时，都需要进行一次寻道。在一个完整的合并趟数中，我们需要把所有 <span class="arithmatex">\(b_r\)</span> 个数据块都读进来，所以模型近似认为这需要 <strong><span class="arithmatex">\(b_r\)</span> 次读寻道</strong>。</li>
<li><strong>写 (Write)</strong>：同样，在写出合并后的新顺串时，模型也悲观地假设每写<strong>一个数据块</strong>都需要一次寻道。因此，这又需要 <strong><span class="arithmatex">\(b_r\)</span> 次写寻道</strong>。</li>
<li><strong>每趟成本</strong>：<span class="arithmatex">\(b_r\)</span> (读) + <span class="arithmatex">\(b_r\)</span> (写) = <span class="arithmatex">\(2b_r\)</span> 次寻道。</li>
</ul>
</li>
<li>
<p>我们初始有 <span class="arithmatex">\(\lceil b_r / M \rceil\)</span> 个顺串。在每个合并趟数中，我们最多能将 <span class="arithmatex">\(M-1\)</span> 个顺串合并成一个。所以，每一趟都会将顺串的数量减少为原来的 <span class="arithmatex">\(1/(M-1)\)</span>。要将初始数量的顺串减少到 1，需要进行的趟数就是以 <span class="arithmatex">\(M-1\)</span> 为底的对数，即 <span class="arithmatex">\(\lceil \log_{M-1} (b_r / M) \rceil\)</span> 趟。</p>
</li>
<li>
<p>对于所有<strong>中间趟数</strong>，成本都是 <span class="arithmatex">\(2b_r\)</span>（读+写）。对于<strong>最后一趟</strong>，我们只需要读取数据进行合并，然后结果可以直接输出给用户或下一个计算步骤，无需写回磁盘。所以最后一趟的寻道成本只有读操作的 <span class="arithmatex">\(b_r\)</span> 次。</p>
</li>
<li>
<p>总的合并趟数是 <span class="arithmatex">\(P = \lceil \log_{M-1} (b_r / M) \rceil\)</span>。其中有 <span class="arithmatex">\(P-1\)</span> 个中间趟数，每个成本是 <span class="arithmatex">\(2b_r\)</span>。还有 1 个最终趟数，成本是 <span class="arithmatex">\(b_r\)</span>。总合并成本 = <span class="arithmatex">\((P-1) \times 2b_r + 1 \times b_r = 2Pb_r - 2b_r + b_r = 2Pb_r - b_r = b_r(2P-1)\)</span>。</p>
</li>
</ol>
<p>代入 <span class="arithmatex">\(P\)</span> 的表达式，就得到：<span class="arithmatex">\(b_r(2 \lceil \log_{M-1} (b_r / M) \rceil - 1)\)</span>。</p>
</details>
<details class="note">
<summary>prove</summary>
<p><a class="glightbox" href="../assets/15-22.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-22.png" /></a></p>
</details>
<hr />
<h4 id="cost-analysis-advanced-version"><strong>Cost analysis</strong>: (advanced version)<a class="headerlink" href="#cost-analysis-advanced-version" title="Permanent link">&para;</a></h4>
<p>1 block per run leads to too many seeks during merge</p>
<p>Instead use <span class="arithmatex">\(b_b\)</span> buffer blocks per run <span class="arithmatex">\(\rightarrow\)</span> read/write <span class="arithmatex">\(b_b\)</span> blocks at a time</p>
<p>Can merge <span class="arithmatex">\(\lfloor M /b_b \rfloor - 1\)</span> runs in one pass</p>
<p>Total number of merge passes required:</p>
<div class="arithmatex">\[\lceil \log_{\lfloor M / b_b \rfloor - 1} (b_r / M) \rceil\]</div>
<p>Block transfers for initial run creation as well as in each pass is 2 <span class="arithmatex">\(b_r\)</span></p>
<p>For final pass, we don’t count write cost, we ignore final write cost for all operations since the output of an operation may be sent to the parent operation without being written to disk.</p>
<p>Thus total number of block transfers for external sorting:</p>
<div class="arithmatex">\[b_r (2 \lceil \log_{\lfloor M / b_b \rfloor - 1} (b_r / M) \rceil + 1)\]</div>
<p><a class="glightbox" href="../assets/15-12.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-12.png" /></a></p>
<hr />
<h4 id="cost-of-seeks-advanced-version"><strong>Cost of seeks</strong>: (advanced version)<a class="headerlink" href="#cost-of-seeks-advanced-version" title="Permanent link">&para;</a></h4>
<p>During run generation: one seek to read each run and one seek to write each run</p>
<ul>
<li>2 <span class="arithmatex">\(\lceil b_r / M \rceil \rightarrow 2 \times [\text{the number of runs}]\)</span></li>
</ul>
<p>During the merge phase</p>
<p>Need 2 <span class="arithmatex">\(\lceil b_r / b_b \rceil\)</span> seeks for each merge pass, except the final one which does not require a write</p>
<p>There are <span class="arithmatex">\(\lceil \log_{\lfloor M / b_b \rfloor - 1} (b_r / M) \rceil\)</span> merge passes</p>
<p>Total number of seeks:</p>
<div class="arithmatex">\[2 \lceil b_r / M \rceil + \lceil b_r / b_b \rceil (2 \lceil \log_{\lfloor M / b_b \rfloor - 1} (b_r / M) \rceil - 1)\]</div>
<details class="note">
<summary>解释</summary>
<p>这个高级版本的核心思想是：<strong>解决 Simple Version 中不切实际的寻道成本问题</strong>。它通过引入一个关键参数 <span class="arithmatex">\(b_b\)</span>（每个输入流的缓冲区大小，单位为块），来实现对磁盘I/O的显著优化。</p>
<p>在简单版本中，我们为每个要合并的顺串(run)分配1个块的内存作为输入缓冲区。在高级版本中，我们为每个顺串分配 <span class="arithmatex">\(b_b\)</span> 个块。这样做的好处是我们可以一次性从磁盘读取一大块数据（<span class="arithmatex">\(b_b\)</span> 个块），而不是读一个块就停一下。</p>
<p>由于总内存 <span class="arithmatex">\(M\)</span> 是固定的，而每个输入流的缓冲区变大了，我们能同时处理的顺串数量就减少了。</p>
<p>假设我们仍然为输出流保留一个缓冲区（大小也为 <span class="arithmatex">\(b_b\)</span>），那么可用于输入的内存为 <span class="arithmatex">\(M - b_b\)</span>。所以我们可以同时处理的输入顺串数量为 <span class="arithmatex">\(\lfloor (M-b_b) / b_b \rfloor = \lfloor M/b_b \rfloor - 1\)</span>。这就是新的<strong>合并路数</strong>。</p>
</details>
<hr />
<h2 id="join-operation">Join Operation<a class="headerlink" href="#join-operation" title="Permanent link">&para;</a></h2>
<h3 id="nested-loop-join">Nested-Loop Join<a class="headerlink" href="#nested-loop-join" title="Permanent link">&para;</a></h3>
<p>In the worst case, if there is enough memory only to hold one block of each relation, the estimated cost is</p>
<p><span class="arithmatex">\(n_r \times b_s + b_r\)</span> block transfers, plus <span class="arithmatex">\(n_r + b_r\)</span> seeks</p>
<p>If the smaller relation fits entirely in memory, use that as the inner relation.</p>
<p>Reduces cost to <span class="arithmatex">\(b_r + b_s\)</span> block transfers and 2 seeks</p>
<p>这是最基础、最"暴力"的连接算法。它的思想极其简单：从第一张表（外层关系 r）中逐条取出记录，然后用这条记录去扫描整张第二张表（内层关系 s），找出所有匹配的记录。</p>
<p>块传输成本: <span class="arithmatex">\(n_r \times b_s + b_r\)</span></p>
<ul>
<li><span class="arithmatex">\(n_r\)</span> 是 r 表的元组总数。<span class="arithmatex">\(b_s\)</span> 是 s 表的总块数。</li>
<li>对于 r 表的每一条记录（共 <span class="arithmatex">\(n_r\)</span> 条），我们都需要完整地扫描一遍 s 表（成本为 <span class="arithmatex">\(b_s\)</span>）。因此这部分成本是 <span class="arithmatex">\(n_r \times b_s\)</span>.</li>
<li>同时，我们还需要完整地读取一遍 r 表本身，成本是 <span class="arithmatex">\(b_r\)</span>.</li>
</ul>
<p>寻道成本: <span class="arithmatex">\(n_r + b_r\)</span></p>
<ul>
<li>每次开始扫描 s 表都需要一次寻道，我们对 r 的每一条记录都要扫一遍 s，所以是 <span class="arithmatex">\(n_r\)</span> 次寻道。</li>
<li>读取 r 表本身时，在最坏假设下（每个块都需要一次寻道），需要 <span class="arithmatex">\(b_r\)</span> 次寻道。</li>
</ul>
<p>优化：如果较小的关系（比如 s）能完全放入内存，那么我们只需要读取 s 一次（成本<span class="arithmatex">\(b_s\)</span>）和读取 r 一次（成本<span class="arithmatex">\(b_r\)</span>），总成本就骤降到 <span class="arithmatex">\(b_r + b_s\)</span>，寻道也只有2次。</p>
<hr />
<h3 id="block-nested-loop-join">Block Nested-Loop Join<a class="headerlink" href="#block-nested-loop-join" title="Permanent link">&para;</a></h3>
<p>Variant of nested-loop join in which every block of inner relation is paired with every block of outer relation.</p>
<p>这是对朴素NLJ的重大改进。它不再"逐条"比较，而是"逐块"比较。它一次性从外层关系 r 读取一个数据块 (Block) 到内存，然后用这个块里的所有记录，去和内层关系 s 的所有块进行比较。</p>
<p><a class="glightbox" href="../assets/15-13.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-13.png" /></a></p>
<p>for each block <span class="arithmatex">\(B_r\)</span> of r do begin
    for each block <span class="arithmatex">\(B_s\)</span> of s do begin
        for each tuple <span class="arithmatex">\(t_r\)</span> in <span class="arithmatex">\(B_r\)</span> do begin
            for each tuple <span class="arithmatex">\(t_s\)</span> in <span class="arithmatex">\(B_s\)</span> do begin
                Check if (<span class="arithmatex">\(t_r\)</span> , <span class="arithmatex">\(t_s\)</span>) satisfy the join condition 
                if they do, add <span class="arithmatex">\(t_r \times t_s\)</span> to the result.
            end
        end
    end
end</p>
<p>Worst case estimate: <span class="arithmatex">\(b_r \times b_s + b_r\)</span> block transfers + <span class="arithmatex">\(2 \times b_r\)</span> seeks</p>
<p>Each block in the inner relation s is read once for each block in the outer relation</p>
<p>Best case: <span class="arithmatex">\(b_r + b_s\)</span> block transfers + 2 seeks</p>
<p>块传输成本: <span class="arithmatex">\(b_r \times b_s + b_r\)</span></p>
<ul>
<li><span class="arithmatex">\(b_r\)</span> 是 r 表的总块数。</li>
<li>对于 r 表的每一个块（共 <span class="arithmatex">\(b_r\)</span> 块），我们都需要完整地扫描一遍 s 表（成本为 <span class="arithmatex">\(b_s\)</span>）。因此这部分成本是 <span class="arithmatex">\(b_r \times b_s\)</span>.</li>
<li>同时，我们还需要完整地读取一遍 r 表本身，成本是 <span class="arithmatex">\(b_r\)</span>.</li>
</ul>
<p>Improvements to block nested loop algorithms:</p>
<p>Use M-2 disk blocks as blocking unit for outer relations, where M = memory size in blocks; use remaining two blocks to buffer inner relation and output</p>
<p>我们不再是"一次一个块"，而是一次性读取尽可能多的 r 的块到内存中。</p>
<p>假设总内存为 <span class="arithmatex">\(M\)</span> 块，我们用 <span class="arithmatex">\(M-2\)</span> 块内存作为 r 的"组块"缓冲区，1块给 s 做输入缓冲，1块做输出缓冲。</p>
<p>Cost = <span class="arithmatex">\(\lceil b_r / (M - 2) \rceil \times b_s + b_r\)</span> block transfers + <span class="arithmatex">\(2 \lceil b_r / (M - 2) \rceil\)</span> seeks</p>
<p>对应改进后的算法，我们需要读取 r 的每个大组块（1次寻道），并为每一次 s 的扫描进行一次寻道。</p>
<p>If r fits in memory ( <span class="arithmatex">\(b_r \le\)</span> M-2)</p>
<p>Cost = <span class="arithmatex">\(b_s + b_r\)</span> block transfers + 2 seeks</p>
<p>If equi-join attribute forms a key on the inner relation, stop inner loop on first match</p>
<p>Scan inner loop forward and backward alternately, to make use of the blocks remaining in buffer (with LRU replacement)</p>
<p><a class="glightbox" href="../assets/15-14.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-14.png" /></a></p>
<details class="note">
<summary>improving and proving</summary>
<p><a class="glightbox" href="../assets/15-23.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-23.png" /></a></p>
</details>
<hr />
<h3 id="indexed-nested-loop-join">Indexed Nested-Loop Join<a class="headerlink" href="#indexed-nested-loop-join" title="Permanent link">&para;</a></h3>
<p>这是一种"精准打击"的算法。它利用内层关系 s 在连接属性上的索引，来避免全表扫描。对于外层关系 r 的每一条记录，它不再是盲目地扫描 s，而是通过索引直接定位到 s 中可能匹配的记录。</p>
<p>Index lookups can replace file scans if</p>
<ul>
<li>join is an equi-join or natural join and</li>
<li>an index is available on the inner relation's join attribute(Can construct an index just to compute a join.)</li>
</ul>
<p>For each tuple <span class="arithmatex">\(t_r\)</span> in the outer relation r, use the index to look up tuples in s that satisfy the join condition with tuple <span class="arithmatex">\(t_r\)</span></p>
<p>Worst case: buffer has space for only one page of r, and, for each tuple in r, we perform an index lookup on s.</p>
<p>Cost of the join: <span class="arithmatex">\(b_r(t_T + t_S) + n_r \times c\)</span></p>
<p>首先，需要完整扫描一遍外层关系 r。</p>
<p>对于 r 中的每一条记录（共 <span class="arithmatex">\(n_r\)</span> 条），都需要进行一次索引查找。c 就是单次索引查找的成本（包括读取索引块和数据块的I/O）。</p>
<details class="note">
<summary>prove</summary>
<p><a class="glightbox" href="../assets/15-24.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-24.png" /></a></p>
</details>
<p>Where c is the cost of traversing index and fetching all matching s tuples for one tuple or r</p>
<p>c can be estimated as cost of a single selection on s using the join condition.</p>
<p>If indices are available on join attributes of both r and s, use the relation with fewer tuples as the outer relation.</p>
<hr />
<h3 id="merge-join">Merge-Join<a class="headerlink" href="#merge-join" title="Permanent link">&para;</a></h3>
<p>这是一种"齐头并进"的算法。它要求两个关系首先在连接属性上排好序，然后像拉拉链一样，同时扫描两个已排序的关系，只需过一遍数据就能完成连接。</p>
<ol>
<li>Sort both relations on their join attribute (if not already sorted on the join attributes).</li>
<li>Merge the sorted relations to join them</li>
</ol>
<ul>
<li>Join step is similar to the merge stage of the sort-merge algorithm.</li>
<li>Main difference is handling of duplicate values in join attribute — every pair with same value on join attribute must be matched</li>
<li>Detailed algorithm in book</li>
</ul>
<p>Can be used only for equi-joins and natural joins</p>
<p>Each block needs to be read only once (assuming all tuples for any given value of the join attributes fit in memory)</p>
<p>Thus the cost of merge join is:</p>
<p><span class="arithmatex">\(b_r + b_s\)</span> block transfers + <span class="arithmatex">\(\lceil b_r / b_b \rceil + \lceil b_s / b_b \rceil\)</span> seeks + the cost of sorting if relations are unsorted.</p>
<p>如果数据未排序：</p>
<p>排序成本通常是主要开销，成本为 $b_r(2 \lceil \log_{M-1} (b_r / M) \rceil + 1) + b_s(2 \lceil \log_{M-1} (b_s / M) \rceil + 1) 数量级的块传输。</p>
<p>如果数据已排序（只计算合并成本）:</p>
<p>块传输成本: <span class="arithmatex">\(b_r + b_s\)</span>。因为我们只需要顺序地完整读取 r 和 s 各一次。</p>
<p>寻道成本: <span class="arithmatex">\(\lceil b_r / b_b \rceil + \lceil b_s / b_b \rceil\)</span>。这是使用大小为 <span class="arithmatex">\(b_b\)</span> 的缓冲区的优化结果，大大减少了寻道次数。</p>
<p><a class="glightbox" href="../assets/15-15.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-15.png" /></a></p>
<details class="note">
<summary>what about cost?</summary>
<p><a class="glightbox" href="../assets/15-25.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-25.png" /></a><a class="glightbox" href="../assets/15-26.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-26.png" /></a><a class="glightbox" href="../assets/15-27.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-27.png" /></a></p>
</details>
<hr />
<p>If the buffer memory size is M pages, in order to minimize the cost of merge join, how to assign M blocks to r and s respectively?</p>
<p>The estimated cost is</p>
<p><span class="arithmatex">\(b_r + b_s\)</span> block transfers + <span class="arithmatex">\(\lceil b_r / x_r \rceil + \lceil b_s / x_s \rceil\)</span> seeks</p>
<p>with (<span class="arithmatex">\(x_r + x_s = M\)</span>)</p>
<p><span class="arithmatex">\(x_r = \sqrt{b_r} \times M / (\sqrt{b_r} + \sqrt{b_s})\)</span> and <span class="arithmatex">\(x_s = \sqrt{b_s} \times M / (\sqrt{b_r} + \sqrt{b_s})\)</span></p>
<p><a class="glightbox" href="../assets/15-16.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-16.png" /></a></p>
<hr />
<p>hybrid merge-join: If one relation is sorted, and the other has a secondary B+-tree index on the join attribute</p>
<p>Merge the sorted relation with the leaf entries of the B+-tree</p>
<p>Sort the result on the addresses of the unsorted relation's tuples</p>
<p>Scan the unsorted relation in physical address order and merge with previous result, to replace addresses by the actual tuples</p>
<p>Sequential scan more efficient than random lookup</p>
<p>当两个关系在连接属性上都存在辅助索引时，可以对未排序的元组执行归并——连接运算的一个变种。该算法通过索引来扫描记录，从而按顺序检索记录。但这种变种有一个很大的缺陷，因为记录可能分散在文件的多个块中，所以每个元组的存取都可能导致一个磁盘块的访问，这样的代价是很大的。</p>
<p>为避免这种代价，我们可以使用一种混合的归并——连接技术，该技术把索引与归并——连接结合在一起。假设有一个关系已排序，另一个未排序，但在连接属性上有 B+ 树辅助索引。混合归并——连接算法(<strong>hybrid merge-join algorithm</strong>)把已排序关系与 B+ 树辅助索引的叶子项进行归并。所得到的结果文件包含已排序关系的元组和未排序关系的元组地址。然后，将该结果文件按未排序关系的元组地址进行排序，从而能够对相关元组按照物理存储顺序进行高效的检索，以最终完成连接。对此技术进行扩展以处理两个未排序关系的工作留给读者作为练习。</p>
<details class="note">
<summary>举例说明混合归并——连接算法 &amp; 处理两个未排序关系的工作</summary>
<p>假设有两个表:</p>
<ul>
<li><strong><code>students</code>（学生表）</strong>：未按任何顺序存储，但在 <code>class_id</code> 上有 B+树辅助索引。</li>
<li><strong><code>classes</code>（班级表）</strong>：已按 <code>class_id</code> 排序（比如按主键聚集索引存储）。</li>
</ul>
<p>现在需要执行如下连接查询:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">.</span><span class="n">class_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">classes</span><span class="p">.</span><span class="n">class_id</span><span class="p">;</span>
</code></pre></div>
<p><strong>混合归并-连接步骤（一表已排序，一表未排序）</strong></p>
<p><strong>1. 已排序表（classes）与未排序表的索引叶子项归并</strong></p>
<ul>
<li><strong>classes表</strong>：已按 <code>class_id</code> 排序（假设存储顺序为 <code>[1班, 2班, 3班]</code>）。</li>
<li><strong>students表的辅助索引</strong>：B+树索引的叶子节点按 <code>class_id</code> 排序，存储的是 <code>(class_id, 学生记录的物理地址)</code>，例如：</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>(1班, addr1) → (1班, addr3) → (2班, addr2) → (3班, addr4)
</code></pre></div>
<p><strong>归并过程</strong>：</p>
<ol>
<li>同时扫描已排序的 <code>classes</code> 表和 <code>students</code> 的辅助索引叶子节点（两者均按 <code>class_id</code> 有序）。</li>
<li>对匹配的 <code>class_id</code>，生成中间结果：<code>(classes 表的班级记录, students 表记录的物理地址)</code>  </li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>(1班数据, addr1), (1班数据, addr3), (2班数据, addr2), (3班数据, addr4)
</code></pre></div>
<p><strong>2. 按物理地址排序中间结果</strong></p>
<p>将中间结果按 <code>students</code> 表记录的物理地址（如 <code>addr1, addr2, addr3, addr4</code>）排序，目的是让后续对 <code>students</code> 表的读取<strong>按物理存储顺序进行</strong>（减少磁盘随机I/O）。</p>
<p><strong>3. 按物理顺序读取 students 表并完成连接</strong></p>
<p>按排序后的物理地址顺序，高效（连续读取）地将 <code>students</code> 表与 <code>classes</code> 表的数据组合成最终结果。</p>
<p><strong>扩展到两个未排序的关系</strong></p>
<p>如果两个表均未排序，但<strong>各自在连接属性上有辅助索引</strong>，可以按以下方式处理：</p>
<p><strong>1. 利用两个表的辅助索引叶子项归并</strong></p>
<ul>
<li>对 <code>students</code> 和 <code>classes</code> 表的 <code>class_id</code> 辅助索引叶子节点（均已按 <code>class_id</code> 排序）执行归并。</li>
<li>生成中间结果: <code>(students表记录的物理地址, classes表记录的物理地址)</code>,例如：</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>(addr1, addrA), (addr3, addrA), (addr2, addrB), (addr4, addrC)
</code></pre></div>
<p><strong>2. 按物理地址排序</strong></p>
<ul>
<li><strong>方案1</strong>：先按 <code>students</code> 表地址排序，读取 <code>students</code> 表数据后，再按 <code>classes</code> 表地址排序读取 <code>classes</code> 表数据。</li>
<li><strong>方案2</strong>（更高效）：将中间结果按<strong>其中一个表（如students）的物理地址排序</strong>，然后：</li>
</ul>
<ol>
<li>按顺序读取 <code>students</code> 表记录，缓存到内存。</li>
<li>再按 <code>classes</code> 表地址排序，读取 <code>classes</code> 表记录并与缓存的学生记录匹配。</li>
</ol>
<p><strong>3. 生成最终连接结果</strong></p>
<p>通过排序后的物理地址顺序，最小化磁盘随机访问，完成连接。</p>
</details>
<hr />
<h3 id="hash-join">Hash-Join<a class="headerlink" href="#hash-join" title="Permanent link">&para;</a></h3>
<details class="note">
<summary>自然连接 v.s. 等值连接</summary>
<p>假设有两个表：</p>
<ul>
<li><strong><code>students</code>（学生表）</strong></li>
</ul>
<table>
<thead>
<tr>
<th><strong>sid</strong></th>
<th><strong>name</strong></th>
<th><strong>class_id</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>张三</td>
<td>101</td>
</tr>
<tr>
<td>2</td>
<td>李四</td>
<td>102</td>
</tr>
</tbody>
</table>
<ul>
<li><strong><code>classes</code>（班级表）</strong></li>
</ul>
<table>
<thead>
<tr>
<th><strong>class_id</strong></th>
<th><strong>class_name</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>101</td>
<td>1班</td>
</tr>
<tr>
<td>102</td>
<td>2班</td>
</tr>
</tbody>
</table>
<p><strong>1. 自然连接（Natural Join）</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">classes</span><span class="p">;</span>
</code></pre></div>
<p><strong>结果</strong>（自动匹配 <code>class_id</code> 并去重）：  </p>
<table>
<thead>
<tr>
<th style="text-align: center;"><strong>sid</strong></th>
<th style="text-align: center;"><strong>name</strong></th>
<th style="text-align: center;"><strong>class_id</strong></th>
<th style="text-align: center;"><strong>class_name</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">张三</td>
<td style="text-align: center;">101</td>
<td style="text-align: center;">1班</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">李四</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">2班</td>
</tr>
</tbody>
</table>
<p><strong>2. 等值连接（Equi-Join）</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">.</span><span class="n">class_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">classes</span><span class="p">.</span><span class="n">class_id</span><span class="p">;</span>
</code></pre></div>
<p><strong>结果</strong>（保留所有列）：</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><strong>sid</strong></th>
<th style="text-align: center;"><strong>name</strong></th>
<th style="text-align: center;"><strong>students.class_id</strong></th>
<th style="text-align: center;"><strong>classes.class_id</strong></th>
<th style="text-align: center;"><strong>class_name</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">张三</td>
<td style="text-align: center;">101</td>
<td style="text-align: center;">101</td>
<td style="text-align: center;">1班</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">李四</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">2班</td>
</tr>
</tbody>
</table>
<p><strong>关键区别总结</strong></p>
<ol>
<li><strong>隐式 vs 显式</strong>  </li>
</ol>
<ul>
<li>自然连接隐式匹配同名列，可能意外关联无关列（如两表都有 <code>created_at</code> 字段）。  </li>
<li>等值连接显式指定条件，更安全可控。</li>
</ul>
<ol start="2">
<li><strong>结果列处理</strong>  </li>
</ol>
<ul>
<li>自然连接自动去重同名列。  </li>
<li>等值连接保留所有列，需手动处理重复列名（如 <code>SELECT students.*, classes.class_name</code>）。</li>
</ul>
<ol start="3">
<li><strong>灵活性</strong>  </li>
</ol>
<ul>
<li>等值连接可以关联不同名的列（如 <code>students.sid = scores.student_id</code>），自然连接无法做到。</li>
</ul>
</details>
<p>Applicable for equi-joins and natural joins.</p>
<p>Hash-Join 是一种执行等值连接 (equi-joins) 效率极高的算法。其核心思想是经典的"分而治之 (Divide and Conquer)"。</p>
<p>它避免了像嵌套循环连接那样进行大量的重复比较，而是通过一个哈希函数，巧妙地将两个大表"分拆"成多个小的数据桶（称为分区 Partition）。由于哈希函数的特性，具有相同连接键的记录必然会进入编号相同的分区。这样，原来一个巨大无比的连接问题，就被分解成了多个"小分区之间"的连接问题，大大降低了问题的复杂度。</p>
<p>A hash function h is used to partition tuples of both relations with common JoinAttrs</p>
<p>h maps JoinAttrs values to {0, 1, ..., n}</p>
<p><span class="arithmatex">\(r_0, r_1, ..., r_{n}\)</span> denote partitions of r tuples</p>
<ul>
<li>Each tuple <span class="arithmatex">\(t_r \in r\)</span> is put in partition <span class="arithmatex">\(r_i\)</span> where i = h(<span class="arithmatex">\(t_r\)</span> [JoinAttrs])</li>
</ul>
<p><span class="arithmatex">\(s_0, s_1, ..., s_{n}\)</span> denote partitions of s tuples</p>
<ul>
<li>Each tuple <span class="arithmatex">\(t_s \in s\)</span> is put in partition <span class="arithmatex">\(s_i\)</span> where i = h(<span class="arithmatex">\(t_s\)</span> [JoinAttrs])</li>
</ul>
<p>而我们也需要在 <span class="arithmatex">\(s_i\)</span> 上构建索引，这个散列索引是在内存中构造的，因此并不需要访问磁盘以检索元组。用于构造此散列索引的散列函数与前面使用的散列函数 h 必须是不同的，但仍然只应用于连接属性上。在索引嵌套——循环连接的过程中，系统使用此索引来检索与探查用输入中的记录相匹配的那些记录。</p>
<p><a class="glightbox" href="../assets/15-17.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-17.png" /></a></p>
<p><strong>Note</strong>: the value n and the hash function h is chosen such that each <span class="arithmatex">\(s_i\)</span> should fit in memory.</p>
<div class="arithmatex">\[n \ge \lceil b_s / M \rceil\]</div>
<p><strong>Note</strong>: In book, <span class="arithmatex">\(r_i\)</span> is denoted as <span class="arithmatex">\(H_{r_i}\)</span> and <span class="arithmatex">\(s_i\)</span> is denoted as <span class="arithmatex">\(H_{s_i}\)</span> and n is denoted as <span class="arithmatex">\(n_h\)</span></p>
<hr />
<p>r tuples in <span class="arithmatex">\(r_i\)</span> need only to be compared with s tuples in <span class="arithmatex">\(s_i\)</span></p>
<p>Need not be compared with s tuples in any other partition, since:</p>
<ul>
<li>an r tuple and an s tuple that satisfy the join condition will have the same value for the join attributes.</li>
<li>If that value is hashed to some value i, the r tuple has to be in <span class="arithmatex">\(r_i\)</span> and the s tuple in <span class="arithmatex">\(s_i\)</span> .</li>
</ul>
<p>散列——连接算法背后的思想是这样的:</p>
<p>假设一个 r 元组与一个 s 元组满足连接条件，那么它们对于连接属性就会取相同的值。若该值被散列成某个值 i ，则 r 元组必在 <span class="arithmatex">\(r_i\)</span> 中且 s 元组必在 <span class="arithmatex">\(s_i\)</span> 中。因此， <span class="arithmatex">\(r_i\)</span> 中的 r 元组只需与 <span class="arithmatex">\(s_i\)</span> 中的 s 元组相比较， <span class="arithmatex">\(r_i\)</span> 中的 r 元组没有必要与其他任何分区里的 s 元组相比较。</p>
<hr />
<h4 id="hash-join-algorithm">Hash-Join Algorithm<a class="headerlink" href="#hash-join-algorithm" title="Permanent link">&para;</a></h4>
<p>The hash-join of r and s is computed as follows.</p>
<ol>
<li>Partition s using hashing function h. When partitioning a relation, one block of memory is reserved as the output buffer for each partition.</li>
<li>Partition r similarly.</li>
<li>For each i:</li>
</ol>
<p>(a) Load <span class="arithmatex">\(s_i\)</span> into memory and build an in-memory hash index on it using the join attribute. This hash index uses a different hash function than the earlier one h.
(b) Read the tuples in <span class="arithmatex">\(r_i\)</span> from the disk one by one. For each 
tuple <span class="arithmatex">\(t_r\)</span> locate each matching tuple <span class="arithmatex">\(t_s\)</span> in <span class="arithmatex">\(s_i\)</span> using the inmemory hash index. Output the concatenation of their attributes.</p>
<ol>
<li>选择一个哈希函数 h 和分区数量 n。这个哈希函数的作用是把连接键（如 user_id）映射到一个分区编号（如 0 到 n）。</li>
<li>分区 s 表： 顺序读取 s 表的每个元组 <span class="arithmatex">\(t_s\)</span>，计算 i = h(t_s.join_key)，然后将 <span class="arithmatex">\(t_s\)</span> 写入到磁盘上的第 i 个分区文件 <span class="arithmatex">\(s_i\)</span> 中。内存中会为每个分区（<span class="arithmatex">\(s_0\)</span> 到 <span class="arithmatex">\(s_n\)</span>）保留一个输出缓冲块，当某个分区的缓冲块满了，就把它刷写到磁盘。</li>
<li>分区 r 表： 对 r 表执行完全相同的操作，使用同一个哈希函数 h，将其分解为分区 <span class="arithmatex">\(r_0, r_1, ...\)</span>.</li>
</ol>
<ul>
<li>需要完整地读一遍 r 和 s，再完整地把它们按分区写回磁盘。成本为 <span class="arithmatex">\(2(b_r + b_s)\)</span> 次块传输。</li>
</ul>
<ol start="4">
<li>构建 (Build):选择一个关系作为构建输入 (Build Input)，通常是较小的那个，即 s。将整个分区 <span class="arithmatex">\(s_i\)</span> 从磁盘读入内存。在内存中，使用一个新的、不同的哈希函数 h2，为 <span class="arithmatex">\(s_i\)</span> 的所有元组建立一个哈希表（Hash Table/Index）。这个哈希表的键是连接属性，值是指向具体元组的指针。这个过程非常快。</li>
<li>另一个关系 r 称为探测输入 (Probe Input)。顺序地从磁盘读取分区 <span class="arithmatex">\(r_i\)</span> 的每一个元组 <span class="arithmatex">\(t_r\)</span>.对于每一个 <span class="arithmatex">\(t_r\)</span>，计算 h2(<span class="arithmatex">\(t_r\)</span>.join_key)，然后利用这个哈希值去内存中的哈希表里查找。这是一个 O(1) 时间复杂度的操作，速度极快。如果找到了匹配的 <span class="arithmatex">\(s\)</span> 表元组（可能会有多个，通过链地址法等解决哈希冲突），则将 <span class="arithmatex">\(t_r\)</span> 和匹配的 <span class="arithmatex">\(t_s\)</span> 拼接起来，作为结果输出。</li>
</ol>
<ul>
<li>需要完整地读一遍所有分区 <span class="arithmatex">\(r_i\)</span> 和 <span class="arithmatex">\(s_i\)</span>。成本为 <span class="arithmatex">\(b_r + b_s\)</span> 次块传输。</li>
</ul>
<p><strong>关键点</strong>：</p>
<ol>
<li>r 和 s 必须使用完全相同的哈希函数 h 和分区数 n，这样才能保证 <span class="arithmatex">\(t_r\)</span>.join_key == <span class="arithmatex">\(t_s\)</span>.join_key 的元组一定会被分配到编号相同的分区对 (<span class="arithmatex">\(r_i\)</span>, <span class="arithmatex">\(s_i\)</span>) 中。</li>
<li>分区数量 n 的选择至关重要。必须保证较小关系 s 的任意一个分区 <span class="arithmatex">\(s_i\)</span> 都能完全载入内存。这就是为什么通常选择 <span class="arithmatex">\(n \ge \lceil b_s / M \rceil\)</span> 的原因。</li>
</ol>
<p>Relation s is called the build input</p>
<p>Relation r is called the probe input</p>
<p>在对关系进行分区后，散列——连接代码的其余部分在各个分区上对 i (i=0,1,...,<span class="arithmatex">\(n_h\)</span>) 执行单独的索引嵌套——循环连接。为此，算法先在每个 <span class="arithmatex">\(s_i\)</span> 上构造(<strong>build</strong>)散列索引，然后用 <span class="arithmatex">\(r_i\)</span> 的元组进行探查(<strong>probe</strong>)(即在 <span class="arithmatex">\(s_i\)</span> 中查找)。关系 s 就是构造用输入(<strong>build input</strong>)，而 r 是探查用输入(<strong>probe input</strong>)。</p>
<p>The value n and the hash function h is chosen such that each build input relation partitions <span class="arithmatex">\(s_i\)</span> should fit in memory.</p>
<p>Typically n is chosen as <span class="arithmatex">\(\lceil b_s / M \rceil \times f\)</span> where f is a "fudge factor(修正因子)", typically around 1.2</p>
<p>The probe input relation partitions <span class="arithmatex">\(r_i\)</span> need not fit in memory</p>
<p>修正因子 (Fudge Factor): 现实中数据可能分布不均（数据倾斜），导致某些分区特别大。为了保险起见，会使用一个修正因子（如1.2）来创建比理论值更多的分区，以确保即使在数据倾斜的情况下，最大的 <span class="arithmatex">\(s_i\)</span> 也能装入内存。</p>
<details class="note">
<summary>why need fudge factor</summary>
<p>必须选择足够大的 <span class="arithmatex">\(n_h\)</span> 值，使得对于每个 i ，在内存中可以容纳构造关系的 <span class="arithmatex">\(s_i\)</span> 分区中的元组以及分区上的散列索引。内存中可以不必容纳探查用关系的分区。最好用较小的输入关系作为构造关系。如果构造关系的规模是 <span class="arithmatex">\(b_s\)</span> 个块，那么要使每个 <span class="arithmatex">\(n_h\)</span> 分区的规模都小于或等于 M ， <span class="arithmatex">\(n_h\)</span> 必须至少是 <span class="arithmatex">\(b_s / M\)</span>。更准确地说，我们还必须考虑该分区上散列索引占用的额外空间，因此 <span class="arithmatex">\(n_h\)</span> 应当相应地取得更大一点。为了简单起见，在分析中我们有时忽略了散列索引所需的空间。</p>
</details>
<hr />
<h5 id="recursive-partitioning">Recursive partitioning<a class="headerlink" href="#recursive-partitioning" title="Permanent link">&para;</a></h5>
<p>Recursive partitioning required if number of partitions n is greater than number of pages M of memory.</p>
<p>Instead of partitioning n ways, use M – 1 partitions for s</p>
<p>Further partition the M – 1 partitions using a different hash function</p>
<p>Use same partitioning method on r</p>
<p>A relation does not need recursive partitioning if M &gt; <span class="arithmatex">\(n_h\)</span> + 1, or equivalently M &gt; (<span class="arithmatex">\(b_s\)</span> / M) + 1, which simplifies (approximately) to M &gt; <span class="arithmatex">\(\sqrt{b_s}\)</span></p>
<p>如果 <span class="arithmatex">\(n_h\)</span> 的值大于或等于内存块数，因为没有足够的缓冲块，关系的分区就不可能一趟完成。这时，完成关系的分区需要重复多趟。在每一趟中，输入能够被划分的最多分区数与可用于输出的缓冲块数同样多。一趟产生的每个桶在下一趟中被单独读入并再次分区以产生更小的分区。一趟中使用的散列函数与上一趟中使用的散列函数不同。系统不断重复对输入的这种分区过程直到构造用输人的每个分区都能被内存容纳为止。这种分区被称为递归分区(recursive partitioning)。</p>
<details class="note">
<summary>Example</summary>
<p>consider a memory size of 12M bytes, divided into 4K bytes blocks; it would contain a total of 3K (3072) blocks. We can use a memory of this size to partition relations of size up to 3K ∗ 3K blocks, which is 36G (3K ∗ 3K ∗ 4K ) bytes.</p>
<p>Similarly, a relation of size 1 gigabyte requires just over <span class="arithmatex">\(\sqrt{256}\)</span> blocks, or 2 megabytes, to avoid recursive partitioning</p>
</details>
<hr />
<h4 id="cost-of-hash-join">Cost of Hash-Join<a class="headerlink" href="#cost-of-hash-join" title="Permanent link">&para;</a></h4>
<p>If recursive partitioning is not required:</p>
<p>cost of hash join is: <span class="arithmatex">\(3(b_s + b_r) + 4 \times n_h\)</span> block transfers + <span class="arithmatex">\(2(\lceil b_r / b_b \rceil + \lceil b_s / b_b \rceil) + 2 \times n_h\)</span> seeks</p>
<p>Block transfers : The partitioning of the two relations r and s calls for a complete reading of both relations, and a subsequent writing back of them. This operation requires <span class="arithmatex">\(2(b_r + b_s)\)</span> block transfers. The build and probe phases read each of the partitions once, calling for further <span class="arithmatex">\(b_s + b_r\)</span> block transfers. The number of blocks occupied by partitions could be slightly more than <span class="arithmatex">\(b_s + b_r\)</span> , as a result of partially filled blocks. Accessing such partially filled blocks can add an overhead of at most 2<span class="arithmatex">\(n_h\)</span> h for each of the relations, since each of the <span class="arithmatex">\(n_h\)</span> partitions could have a partially filled block that has to be written and read back. Thus, a hash join is estimated to require: <span class="arithmatex">\(3(b_r + b_s) + 4 n_h\)</span> block transfers.</p>
<p>Seeks: Assuming <span class="arithmatex">\(b_b\)</span> b blocks are allocated for the input buffer and each output buffer, partitioning requires a total of <span class="arithmatex">\(w(b_r / b_b + b_s / b_b)\)</span> seeks. The build and probe phases require only one seek for each of the <span class="arithmatex">\(n_h\)</span> partitions of each relation, since each partition can be read sequentially. The hash join thus requires <span class="arithmatex">\(2(b_r / b_b + b_s / b_b) + 2 n_h\)</span> seeks.</p>
<p>If recursive partitioning required:</p>
<p>number of passes required for partitioning build relation s to less than M blocks per partition is <span class="arithmatex">\(\lceil \log_{\lfloor M / b_b \rfloor - 1} (b_s / M) \rceil\)</span></p>
<p>best to choose the smaller relation as the build relation.</p>
<p>Total cost estimate is: <span class="arithmatex">\(2(b_r + b_s) \lceil \log_{\lfloor M / b_b \rfloor - 1} (b_s / M) \rceil + b_s + b_r\)</span> block transfers + <span class="arithmatex">\(2(\lceil b_r / b_b \rceil + \lceil b_s / b_b \rceil) \lceil \log_{\lfloor M / b_b \rfloor - 1} (b_s / M) \rceil\)</span> seeks</p>
<p>If the entire build input can be kept in main memory no partitioning is required</p>
<p>Cost estimate goes down to <span class="arithmatex">\(b_r + b_s\)</span></p>
<details class="note">
<summary>Chinese version</summary>
<p><a class="glightbox" href="../assets/15-29.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-29.png" /></a><a class="glightbox" href="../assets/15-30.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-30.png" /></a></p>
</details>
<hr />
<h2 id="other-operations">Other Operations<a class="headerlink" href="#other-operations" title="Permanent link">&para;</a></h2>
<p><strong>Duplicate elimination</strong> can be implemented via hashing or sorting.</p>
<p>On sorting duplicates will come adjacent to each other, and all but one set of duplicates can be deleted.</p>
<p>我们可以通过排序的方法来容易地实现去重。作为排序的结果，相同的元组会彼此邻近地出现，那就删除所有相同元组只保留一个副本即可。对于外排序——归并而言，在创建归并段时就可以发现重复元组，并在将归并段写到磁盘之前去除重复元组，从而减少块传输的次数。剩余的重复元组可在归并过程中去除，并且最后的有序归并段是没有重复元组的。在最坏情形下，去重的估计代价与对该关系进行排序的最坏情形下的估计代价是一样的。</p>
<p>Optimization: duplicates can be deleted during run generation as well as at intermediate merge steps in external sort-merge.</p>
<p>Hashing is similar – duplicates will come into the same bucket.</p>
<p>我们也可通过散列来实现去重，就像在散列-连接算法里一样。首先，基于整个元组上的一个散列函数对关系进行分区。接下来读入每个分区，并创建一个内存散列索引。在创建散列索引时，只有不在索引中的元组才被插入:否则，该元组就被丢弃。在分区中的所有元组都被处理完后，将散列索引中的元组写到结果中。其估计代价与在散列-连接中处理构造关系(分区并读入每个分区)的代价是一样的。</p>
<p><strong>Projection</strong>:</p>
<p>perform projection on each tuple followed by duplicate elimination.</p>
<p><strong>Aggregation</strong> can be implemented in a manner similar to duplicate elimination.</p>
<p>聚集运算可以用与去重相同的方式来实现。我们或者使用排序或者使用散列，就像我们在去重中所做的那样，只不过基于分组属性。但是，我们不是去除对于分组属性取值相同的元组，而是将它们聚集成组，并对每一组应用聚集运算以得到结果。</p>
<p>Sorting or hashing can be used to bring tuples in the same group together, and then the aggregate functions can be applied on each group.</p>
<p>Optimization: combine tuples in the same group during run generation and intermediate merges, by computing partial aggregate values</p>
<p>对于诸如 <code>min、max、sum、count</code> 和 <code>avg</code> 那样的聚集函数而言，实现聚集运算的估计代价和去重的代价是一样的。</p>
<p>For count, min, max, sum: keep aggregate values on tuples found so far in the group. When combining partial aggregate for count, add up the aggregates</p>
<p>For avg, keep sum and count, and divide sum by count at the end</p>
<p><strong>Set operations</strong> (<span class="arithmatex">\(\cap, \cup and ——\)</span>) can either use variant of merge-join after sorting, or variant of hash-join.</p>
<p>对于所有这些运算，两个排好序的输入关系仅需扫描一次，因此如果两个关系按相同的次序排好序，其代价为 <span class="arithmatex">\(b_r + b_s\)</span> 次块传输。假设最坏情况下每个关系只有一个缓冲块，则总共需要 <span class="arithmatex">\(b_r + b_s\)</span> 次磁盘寻道再加上 <span class="arithmatex">\(b_r + b_s\)</span> 次块传输。通过分配额外的缓冲块可以减少寻道的次数。若关系一开始并未排序，则还要包含排序的代价。在执行集合运算时，任何排序次序均可使用，只要两个输入具有相同的排序次序即可。</p>
<p>E.g., Set operations using hashing:</p>
<ol>
<li>Partition both relations using the same hash function</li>
<li>Process each partition i as follows.</li>
</ol>
<p>(a) Using a different hashing function, build an in-memory hash index on <span class="arithmatex">\(r_i\)</span>
(b) Process <span class="arithmatex">\(s_i\)</span> as follows</p>
<p>散列提供了实现这些集合运算的另一种方式。对于每种运算的第一步使用相同的散列函数对两个关系进行分区，并由此创建出分区 <span class="arithmatex">\(r_0, r_1, \cdots, r_{n_h}\)</span> 以及 <span class="arithmatex">\(s_0, s_1, \cdots, s_{n_h}\)</span>。然后根据运算的不同，系统对 i = 0, 1, ..., <span class="arithmatex">\(n_h\)</span> 中的每个分区执行不同运算步骤。</p>
<p><span class="arithmatex">\(r \cup s\)</span>: </p>
<p>a. Add tuples in <span class="arithmatex">\(s_i\)</span> to the hash index if they are not already in it.
b. At end of <span class="arithmatex">\(s_i\)</span> add the tuples in the hash index to the result.</p>
<details class="note" open="open">
<summary>others</summary>
<p><a class="glightbox" href="../assets/15-18.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-18.png" /></a></p>
<p><a class="glightbox" href="../assets/15-19.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-19.png" /></a></p>
<p><a class="glightbox" href="../assets/15-20.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-20.png" /></a></p>
<p><a class="glightbox" href="../assets/15-31.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-31.png" /></a></p>
</details>
<hr />
<h2 id="evaluation-of-expressions">Evaluation of Expressions<a class="headerlink" href="#evaluation-of-expressions" title="Permanent link">&para;</a></h2>
<p>目前为止，我们只学习了如何执行单个关系运算。现在我们考虑如何执行包含多种运算的表达式。一种显而易见的表达式执行方式是以一种恰当的次序每次只执行一个运算;每次执行的结果被物化(materialized)到一个临时关系中以备后用。这种方式的缺点是需要构造临时关系，这些临时关系(除非它们非常小)必须写到磁盘上。另一种可替代方式是在流水线(pipeline)中同时执行多个运算，将一个运算的结果传递给下一个，而不必保存临时关系。</p>
<hr />
<h3 id="materialization">Materialization<a class="headerlink" href="#materialization" title="Permanent link">&para;</a></h3>
<p>为了直观地理解如何执行一个表达式，最容易的方式是看一看以算子树(operator tree)对表达式所做的图形化表示。</p>
<p><a class="glightbox" href="../assets/15-32.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="img" src="../assets/15-32.png" /></a></p>
<p>如果应用物化方法，我们从表达式中的最底层运算(在树的底部)开始。在我们的示例中，只有一个这样的运算: deparment 上的选择运算。最底层运算的输入是数据库中的关系。我们使用前面学习过的算法来执行这些运算，并且将结果存储在临时关系中。我们可以使用这些临时关系来执行树中更高一层的运算:这时的输入要么是临时关系，要么是存储在数据库中的关系。在我们的示例中，连接的输入是 instructor 关系以及在 deparment 上通过选择建立的临时关系。现在可以执行连接，并创建另一个临时关系。</p>
<p>通过重复该过程，我们最终可以执行位于树的根节点处的运算，从而得到表达式的最终结果。在我们的示例中，通过使用由连接创建的临时关系作为输人来执行根节点处的投影运算投影，就得到了最终的结果。</p>
<p>刚才描述的执行方式被称为物化执行(materialized evaluation)，因为每个中间运算的结果都被创建(物化)，然后用于下一层运算的执行。</p>
<p>物化执行的代价不单单是所涉及的运算代价的总和。当计算算法的估计代价时，我们忽略了将运算结果写到磁盘的代价。为了计算按这种方式执行一个表达式的代价，必须把所有运算的代价相加，还要加上把中间结果写到磁盘的代价。假设结果记录在缓冲区中积累，并且当缓冲区已满时，再把它们写到磁盘上。写出的块数 <span class="arithmatex">\(b_r\)</span> ,可按 <span class="arithmatex">\(n_r/f_r\)</span> 来估计，其中 <span class="arithmatex">\(n_r\)</span> 是结果关系 r 中元组的估计数，<span class="arithmatex">\(f_r\)</span> 是结果关系的块因子(blocking factor)，也就是每个块中可容纳的 r 的记录数。除了传输时间之外，还可能需要一些磁盘寻道，因为磁头在连续的写操作之间可能会进行移动。寻道的次数可以估计为 <span class="arithmatex">\(b_r/b_b\)</span> ，其中 <span class="arithmatex">\(b_b\)</span> 是输出缓冲块的规模(以块数计算)。</p>
<p><strong>双缓冲</strong>(double buffering)(使用两块缓冲区，其中一块用于连续执行算法，而另一块用于写出结果)通过并行执行 CPU 活动与 I/O 活动，允许算法执行得更快。通过为输出缓冲区分配额外的块以及一次写出多个块，可以减少寻道的次数。</p>
<hr />
<h3 id="pipelining">Pipelining<a class="headerlink" href="#pipelining" title="Permanent link">&para;</a></h3>
<p>通过减少产生的临时文件数，我们可以提高查询执行的效率。减少临时文件数是通过将多个关系运算组合成一个运算的流水线来实现的，其中一个运算的结果将传送到流水线中的下一个运算。刚刚描述的这种执行方式叫作流水线执行(pipelined evaluation)。</p>
<p>如果采用物化方式，执行中将涉及创建存放连接结果的临时关系，然后为了执行投影又将此连接结果读回。这些运算可按如下方式组合:当连接运算产生一个它的结果元组时，马上将该元组传送给投影运算去处理。通过将连接与投影组合起来，我们避免了中间结果的创建，从而直接产生最终结果。</p>
<p>创建运算的流水线可以带来两种好处:</p>
<ol>
<li>它消除了读和写临时关系的代价，从而减少了查询执行代价。请注意，我们前面看到过的用于每个运算的代价公式都包括从磁盘读取结果的代价。如果运算 <span class="arithmatex">\(o_i\)</span> 的输入是从前面的运算 <span class="arithmatex">\(o_j\)</span> 流水线化而来的，则 <span class="arithmatex">\(o_i\)</span> 的代价就不应包括从磁盘读取输入的代价;我们前面看到过的代价公式可以做相应的修改。</li>
<li>如果一个查询执行计划的根算子及其输入被合并在流水线中，那么就可以迅速开始产生查询结果。如果在结果生成时就把它们显示给用户，这可能相当有用，因为否则在用户看到任何查询结果之前可能会存在一个长时间的延迟。</li>
</ol>
<p>Pipelines can be executed in either of two ways:</p>
<ol>
<li>demand-driven pipeline</li>
</ol>
<p>在一条需求驱动流水线(demand-driven pipeline)中，系统不停地向位于流水线顶端的运算发出需要元组的请求。每当一个运算收到需要元组的请求时，它就计算待返回的下一个(若干个)元组并返回这些元组。若该运算的输入不是流水线化的，则待返回的下一个(若干个)元组可以从输入关系计算出来，同时系统跟踪到目前为止已经返回了哪些元组。若该运算具有一些流水线化的输入，那么它也发出请求以获得来自其流水线输入的元组。该运算使用它从其流水线输入接收到的元组，并为其输出计算这些元组，然后把它们上传到它的父节点。</p>
<ol start="2">
<li>producer-driven pipeline</li>
</ol>
<p>在一条生产者驱动流水线(producer-drivenpipeline)中，各运算并不等待产生元组的请求，而是积极地(eagerly)生产元组。生产者驱动流水线中的每一个运算都被建模成系统中一个单独的进程或线程，它从其流水线化的输入中取出元组流，并产生一个元组流作为其输出</p>
<hr />
<details class="question">
<summary>为什么顺序扫描比随机查找更高效？</summary>
<ul>
<li><strong>减少磁盘寻道时间：</strong> 磁盘读取数据时，磁头需要移动到正确的磁道（寻道）和扇区（旋转延迟）。随机查找意味着磁头需要在磁盘上频繁地跳跃，导致大量的寻道时间和旋转延迟，从而降低了 I/O 性能。</li>
<li><strong>利用磁盘预读：</strong> 当按物理地址顺序扫描时，操作系统和磁盘控制器通常会进行预读操作，即预测即将需要的数据并提前加载到缓冲区中。这样一来，后续的读取操作很可能直接从缓冲区中获取，而无需再次访问磁盘，显著提高了数据读取速度。</li>
</ul>
<p><strong>总结：</strong></p>
<p>混合归并连接的策略充分利用了一个关系已经排序的优势以及另一个关系上的 B+ 树索引。通过先将排序关系与索引叶子节点归并，然后对未排序关系的地址进行排序，最后以物理地址顺序扫描未排序关系并完成连接，该算法旨在最小化磁盘的随机访问，从而提高连接操作的效率。与完全随机地根据地址查找未排序关系的元组相比，顺序扫描能够更有效地利用磁盘 I/O，从而提升整体性能。</p>
</details>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年6月17日 14:41:42 CST">2025年6月17日 14:41:42</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年5月11日 15:15:46 CST">2025年5月11日 15:15:46</span>
  </span>

    
    
    
  </aside>


  




  <h2 id="__comments">评论</h2>
  <script src="https://giscus.app/client.js"
        data-repo="Melody12020831/Notebook"
        data-repo-id="R_kgDONR_9AA"
        data-category="Announcements"
        data-category-id="DIC_kwDONR_9AM4CkboN"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 <a href="https://github.com/Melody12020831" target="_blank" rel="noopener">Melody</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Melody12020831/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top", "navigation.path", "toc.follow", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://gcore.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../../css/javascripts/tablesort.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>